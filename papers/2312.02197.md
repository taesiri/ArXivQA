# [Exploiting Diffusion Priors for All-in-One Image Restoration](https://arxiv.org/abs/2312.02197)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Image restoration tasks like dehazing, low-light enhancement, and denoising typically require separate models that are designed for each specific degradation type. This paper aims to develop a single framework that can perform all-in-one image restoration for different degradation types in a zero-shot manner without needing to retrain the model.  

Proposed Solution:
The paper proposes a framework called ZeroAIR that exploits the image priors learned by a pretrained diffusion model to achieve all-in-one image restoration. The key ideas are:

1) Test-time degradation modeling (TDM): Learns an approximate degradation model from the input degraded image by optimizing a neural network to make clean images from the diffusion model look similar to the degraded image when passed through this network.

2) Three-stage diffusion guidance (TDG): Guides the diffusion model to generate the clean image in three stages by attending to different levels of information from the degraded image to match the varying priors in the diffusion model during sampling.

By alternatively performing TDM to model degradations and TDG to guide sampling at each timestep, the framework can restore images with unknown degradations without retraining.

Main Contributions:
- Proposes a way to achieve general image restoration in a single framework by exploiting diffusion priors
- Introduces test-time learning of degradation models to match input image  
- Develops three-stage guidance strategy tailored to temporal dynamics of diffusion sampling
- Demonstrates state-of-the-art or comparable results to task-specific methods for image dehazing, low-light enhancement, and denoising

The key advantage is performing competitive all-in-one image restoration without needing to retrain the model for new tasks, which is enabled by test-time adaptation and dynamic guidance.
