# [Controllable Diverse Sampling for Diffusion Based Motion Behavior   Forecasting](https://arxiv.org/abs/2402.03981)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Existing trajectory prediction methods face challenges with mode averaging due to data imbalance and struggle to generate diverse, scene-compliant trajectories. 
- Methods relying on priors or generative models often suffer from mode collapse or averaging when trained on single ground truth data.

Proposed Solution:
- The paper proposes a novel framework called Controllable Diffusion Trajectory (CDT) that uses a conditional denoising diffusion model to generate diverse, controllable trajectories.

- It incorporates a mode classifier to estimate vehicle's behavior based on road information to guide trajectory sampling. 

- Transformer-based denoiser takes historical trajectories, maps, time steps and behavior tokens (straight, left turn, right turn) as input to generate trajectories.

- Behavior tokens explicitly control trajectory modalities to avoid data imbalance issues. Endpoint tokens can also be used to guide accurate trajectory generation.

Main Contributions:

- A conditional diffusion model based trajectory prediction framework with controllable behavior tokens for multimodal diverse trajectory generation.

- Behavior tokens enable explicit control over modalities to overcome data imbalance and mode collapse issues.

- Ablation studies validate the model components and diffusion steps.

- Experiments on Argoverse 2 dataset show the model generates more diverse and scene-compliant trajectories compared to state-of-the-art methods. Endpoint conditioned model achieves excellent accuracy.
