# [CAS: A General Algorithm for Online Selective Conformal Prediction with   FCR Control](https://arxiv.org/abs/2403.07728)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
The paper studies the problem of post-selection predictive inference in an online fashion. Specifically, at each time step $t$, a feature-response pair $(X_t,Y_t)$ is observed. An online selection rule $\Pi_t(\cdot)$ is used to decide whether to report a prediction interval for $Y_t$ based on $X_t$ and previous data. The goal is to construct valid prediction intervals that have guaranteed coverage conditional on being selected (selection-conditional coverage) while controlling the false coverage-statement rate (FCR), which measures the average miscoverage rate over time. This is challenging due to the temporal dependence introduced by the online selection rule.

Proposed Solution: 
The paper proposes an algorithm called CAS (Calibration After Adaptive Selection) that wraps around any prediction model to output selective prediction intervals. The key ideas are:

1) Use an adaptive selection rule on past data to construct a calibration set whenever a point is selected at time $t$. This is designed carefully for different selection rules to ensure exchangeability after selection.  

2) Report conformal prediction intervals using quantiles of residuals on the calibration set.

Main Contributions:

1) Proved that CAS guarantees finite-sample, distribution-free selection-conditional coverage for two classes of online selection rules: decision-driven rules and rules using symmetric thresholds.

2) Showed that CAS provably controls FCR under the target level for decision-driven rules without distributional assumptions. For symmetric thresholds, derived FCR control bounds.

3) Proposed a variant of CAS built on top of dynamic conformal inference methods to achieve long-run FCR control under distribution shift.

4) Demonstrated through extensive experiments on synthetic and real datasets that CAS effectively controls FCR while providing shorter prediction intervals compared to benchmarks.

Overall, the paper provides a general and flexible framework for selective predictive inference that can be applied under different online selection mechanisms with both theoretical and empirical backing.
