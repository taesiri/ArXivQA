# [CityFlowER: An Efficient and Realistic Traffic Simulator with Embedded   Machine Learning Models](https://arxiv.org/abs/2402.06127)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem: 
- Traditional traffic simulators rely on rule-based models to govern driving behaviors, but these oversimplify behaviors and result in unrealistic simulations. 
- Some simulators allow integrating ML models via APIs to provide more realistic behaviors, but this approach faces challenges in scalability and efficiency as vehicle numbers increase due to expensive simulator-model communications.

Proposed Solution:
- The authors propose CityFlowER, an advancement to the CityFlow simulator, which efficiently enables realistic city-scale traffic simulation. 
- CityFlowER innovatively pre-embeds ML models within the C++ simulator codebase to eliminate the need for external API calls. This allows blending rule-based and learned models to govern individual vehicle behaviors.

Key Contributions:
- Proposes a simulator-level behavior model pre-embedding mechanism for efficient and flexible simulation.
- Implements this in CityFlowER by directly compiling ML models into the simulator using C++ LibTorch.
- Shows CityFlowER can accurately recover behaviors from CityFlow and SUMO.
- Demonstrates efficiency on par with baseline simulators and significantly faster than API-based simulation.
- Enables flexible specification of diverse driving models for individual vehicles.
- Overall, advances state-of-the-art in microscopic traffic simulation through an efficient and extensible architecture for integrating realistic learned driving models.

In summary, this paper makes traffic simulation significantly more realistic by pre-embedding machine learning models directly into the simulator source code to govern driving behaviors, while retaining computational efficiency, flexibility, and scalability. This helps enable more reliable analyses and planning for transportation systems.
