# [Demonstrate-Search-Predict: Composing retrieval and language models for   knowledge-intensive NLP](https://arxiv.org/abs/2212.14024)

## What is the central research question or hypothesis that this paper addresses?

Based on my reading of the paper, the central research question appears to be:How can we design composable functions that allow complex interactions between frozen language models (LMs) and retrieval models (RMs) for knowledge-intensive NLP tasks using only natural language instructions and operations on texts? The key hypothesis seems to be that by relying entirely on passing natural language texts and scores between a frozen LM and RM, it is possible to build sophisticated task-specific strategies that outperform existing "retrieve-then-read" pipelines for in-context learning on knowledge-intensive tasks. The paper introduces the Demonstrate-Search-Predict (DSP) framework to address this question. DSP provides composable functions to bootstrap training examples (Demonstrate), gather relevant information (Search), and generate grounded predictions (Predict). By composing these functions into deliberate programs tailored to a task, DSP aims to enable more reliable and effective use of frozen LMs and RMs compared to simple retrieve-then-read pipelines. The results on question answering datasets appear to validate the hypothesis, showing gains over vanilla LMs and standard pipelines.In summary, the central research question is how to unlock sophisticated interactions between LMs and RMs using only natural language, and DSP represents a proposed approach and framework based on the hypothesis that composable functions can enable complex, task-specific strategies that improve on existing methods. The gains demonstrated provide evidence supporting the validity of the hypothesis.


## What is the main contribution of this paper?

Based on my reading of the paper, the main contributions are:1. Introducing the Demonstrate-Search-Predict (DSP) framework for retrieval augmented in-context learning. DSP provides composable functions to implement in-context learning systems as programs that systematically decompose complex problems into smaller steps/transformations that the language model (LM) and retrieval model (RM) can handle more reliably. 2. Showing how DSP can express sophisticated task-specific strategies by composing basic techniques like bootstrapping annotations, multi-hop search, query rewriting, passage fusion, etc. This reveals new possibilities for retrieval augmented in-context learning.3. Implementing DSP programs for question answering in open-domain, multi-hop, and conversational settings. Despite low development effort, these programs establish new state-of-the-art in-context learning results, delivering considerable gains over vanilla LMs, retrieve-then-read pipelines, and contemporaneous self-ask pipelines.4. Arguing conceptually that the ability to pass natural language texts between frozen LMs and RMs creates opportunities for sophisticated interactions between them. If realized, this could enable rapid development of grounded AI systems at a high level of abstraction.In summary, the main contribution is introducing the DSP framework to reveal and leverage the potential for composing retrieval and language models via deliberative programs operating on natural language texts. The gains on various QA tasks demonstrate this potential.


## How does this paper compare to other research in the same field?

Here are a few key points comparing this paper to other related work:- This paper introduces the DSP (Demonstrate-Search-Predict) framework for composably building retrieval-augmented language models. Other recent work has explored retrieving passages to augment language model prompts, but DSP provides a more structured way to integrate retrieval with several reusable stages.- A key contribution is the "demonstrate" stage which can automatically annotate training examples with intermediate steps like search queries. This provides a form of weak supervision to train retrieval-based pipelines without hand-labeling each intermediate step. Other related work on multi-hop QA and conversational search typically requires more hand-labeled data.- For search, the paper emphasizes deliberate strategies where the LM and retriever cooperate, compared to standard "retrieve-then-read" pipelines. The composability of DSP makes it convenient to explore techniques like multi-hop reasoning, query rewriting, and result fusion.- For prediction, the paper discusses aggregating information across passages and sampling multiple pipelines. Related work has looked at some of these ideas like marginalizing across passages, but DSP provides a unified framework.- The empirical results are very competitive, achieving new SOTA for GPT-3.5 on SQuAD, HotpotQA, and QReCC with minimal tuning. Other comparable in-context learning results require more expensive LMs or more hand-engineering.- An open question is whether the DSP framework can be generalized to other tasks besides QA. The composable structure seems flexible enough to apply more broadly but this hasn't been demonstrated yet.Overall, the paper makes nice conceptual and practical contributions over existing retrieval-augmented in-context learning techniques. The framework and reusable capabilities like automatic annotation set it apart from prior efforts.


## What future research directions do the authors suggest?

Based on my reading of the paper, some of the main future research directions suggested by the authors include:- Developing more sophisticated DSP programs and exploring additional tasks/datasets. The authors mention they will include results on additional held-out test tasks and datasets in a future version of the paper. This suggests exploring how DSP can be applied to more tasks is an important direction.- Trying different choices of pretrained language models and retrieval models. The authors currently use GPT-3.5 and ColBERTv2, but mention evaluating with additional LM and RM choices in the future. Exploring how different module choices impact DSP performance seems like an important direction.- Extending the DSP primitives and developing more ways of composing modules. The paper introduces core DSP primitives like annotate, sample, generate, etc. but the authors mention some primitives like branch are still in progress. Expanding these primitives and finding new ways to combine LM and RM modules is suggested as a direction.- Applying DSP to additional domains beyond QA like summarization, translation, etc. The current DSP framework seems well-suited for QA but could likely be adapted to other text generation tasks. Exploring this is suggested.  - Developing better aggregation strategies for combining multiple passages/predictions. The paper mentions this as a way to potentially improve performance when there is a large amount of evidence.- Exploring how in-context learning could facilitate training the LM/RM. The current DSP framework uses frozen modules, but the authors suggest in-context learning could be used for "simulating training data" to adapt the modules.In summary, the key directions include developing more DSP programs/tasks, trying different module combinations, extending the primitives, applying DSP to new domains, improving aggregation strategies, and exploring ways to adapt modules.
