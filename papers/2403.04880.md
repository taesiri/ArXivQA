# [An Item is Worth a Prompt: Versatile Image Editing with Disentangled   Control](https://arxiv.org/abs/2403.04880)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper "An Item is Worth a Prompt: Versatile Image Editing with Disentangled Control":

Problem:
- Text-to-image diffusion models (DPMs) have shown great success in image generation, but editing generated images remains challenging. Directly editing words in text prompts often leads to completely different images instead of edits. Existing editing methods rely on spatial masks or additional trained modules which are often ignored by DPMs, resulting in inharmonic editing.

Proposed Solution: 
- The paper proposes a framework called Disentangled-Edit (D-Edit) for versatile image editing with diffusion models. The key ideas are:
  1) Disentangled Control: Cross-attention layers in DPMs are disentangled into separate item-prompt interactions to minimize influence across items during editing.
  2) Unique Item Prompts: Each image item is associated with a special prompt consisting of new tokens, governing its generation. 

- Specifically, the image is segmented and each item is assigned a unique prompt with newly added vocabulary tokens. The text encoder embeddings and UNet model weights are finetuned to establish item-prompt associations and properly comprehend the new tokens and disentangled attention. Various editing operations are then achieved by changing item prompts, masks and associations between them.

Main Contributions:
- Propose disentangled control through grouped cross-attention to minimize influence across items during editing.
- Establish unique item-prompt associations for fine-grained control over image regions.
- Enable text-based, image-based, mask-based and removal editing operations within a unified framework.
- Achieve state-of-the-art performance on various editing tasks while better preserving original image information.
- First framework to support mask-based editing and combine text & image-based editing.

The paper demonstrates the quality and versatility of D-Edit through qualitative and quantitative experiments on diverse images.
