# [A Convenient Category for Higher-Order Probability Theory](https://arxiv.org/abs/1701.02547)

## What is the main contribution of this paper?

 Based on my understanding, the main contribution of this paper is introducing the notion of "quasi-Borel spaces" as a new foundation for higher-order probability theory and probabilistic programming languages. 

Specifically, the paper shows:

- Quasi-Borel spaces form a cartesian closed category that supports higher-order functions, unlike the traditional category of measurable spaces which is not cartesian closed. This allows defining probability distributions on higher-order functions.

- There is a natural notion of probability measure on quasi-Borel spaces. The space of all probability measures forms a monad, providing semantics for probabilistic programming languages. 

- Quasi-Borel spaces allow proving results like de Finetti's theorem that only hold for certain "well-behaved" measurable spaces classically. This allows better managing the sources of randomness compared to arbitrary measurable spaces.

- Key ideas involving randomization can be expressed more cleanly using the function space structure of quasi-Borel spaces. For example, the randomization lemma which shows probability kernels arise from random functions becomes a statement about a quotient space.

- Quasi-Borel spaces are given a canonical categorical status using the notion of extensional presheaves. They conservatively extend standard Borel spaces and can serve as their higher-order counterpart.

So in summary, the main contribution is providing a new foundation for probability theory and semantics of probabilistic programs that supports higher-order functions and handles randomness better than arbitrary measurable spaces. The notion of quasi-Borel space is the key conceptual innovation.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

 Here is a one sentence summary of the paper:

The paper introduces quasi-Borel spaces, a new foundation for probability theory that supports higher-order functions and continuous probability distributions while still allowing key results like de Finetti's theorem.


## How does this paper compare to other research in the same field?

 This paper introduces the notion of quasi-Borel spaces as a new foundation for higher-order probability theory and probabilistic programming languages. Here are some key ways it relates to other work:

- It builds on the authors' prior work on using the category of functors $[\mathbf{SMeas}^{op}, \mathbf{Set}]$ as a model of higher-order probability theory. Quasi-Borel spaces are more concrete and well-pointed.

- It is inspired by notions like quasi-topological spaces and diffeological spaces from topology/geometry, but applies the idea of structured spaces to probability theory. 

- It relates to work on probabilistic powerdomains, as an alternative foundation that avoids some of their difficulties. The measures resemble continuous random variables.

- It connects conceptually to domains of random variables from domain theory. An open question is making this connection formally.

- It is complementary to recent operational semantics for probabilistic languages, providing a denotational semantics based on quasi-Borel spaces.

- The results on exchangeability generalize de Finetti's theorem by better managing the randomness source. This relates to work on computable probability.

Overall, the paper carves out a novel approach to higher-order probability theory using quasi-Borel spaces. It demonstrates the usefulness of this notion and relates it to several threads of research. The concrete and well-pointed setting appears to offer advantages over previous category-theoretic models.


## What future research directions do the authors suggest?

 Based on my reading of the paper, some of the main future research directions suggested by the authors include:

- Revisiting results about logical relations and computability in probabilistic programming languages using quasi-Borel spaces, and seeing whether they can be extended beyond standard Borel spaces. The authors mention two recent papers on operational semantics and logical relations for probabilistic programs, and suggest it could be interesting to re-explore those topics in the new semantic setting proposed in this paper.

- Connecting quasi-Borel spaces more formally to domain-theoretic approaches to probability and integration. The authors mention connections at an intuitive level, but more formal relationships could be made. 

- Developing an "ordered" version of quasi-Borel spaces enriched over dcpos to support recursion. The authors suggest this as a direction to better connect with domain theory.

- Finding a convenient cartesian closed subcategory of quasi-Borel spaces by adding more morphisms. The authors have added objects to make measurable spaces cartesian closed, but suggest also adding more morphisms to identify more objects.

- Exploring connections to sheaf-theoretic approaches to probability like Alex Simpson's work. The authors show quasi-Borel spaces can be characterized as sheaves, so closer relationships could be made there.

- Investigating more model theory, domain theory, and programming language theory in the setting of quasi-Borel spaces. Now that the basic category theory is developed, it can serve as a foundation for exploring more semantics and logic for probabilistic and stochastic systems.

So in summary, the main suggestions are to connect quasi-Borel spaces back to existing work on semantics and logic for probabilistic programming, and to further develop the foundations of the quasi-Borel space model itself.


## Summarize the paper in one paragraph.

 Here is a one paragraph summary of the paper:

This paper introduces quasi-Borel spaces as a new foundation for higher-order probability theory that can handle higher-order functions. Quasi-Borel spaces are sets equipped with random variables valued in the space, forming a cartesian closed category that supports probability measures. This allows expressing sophisticated probabilistic models with higher-order functions while still having good properties like supporting integration and pushforward of measures. The authors demonstrate the utility of quasi-Borel spaces through examples like Bayesian regression and generalizing de Finettiâ€™s theorem. Overall, quasi-Borel spaces provide a convenient category for higher-order probability theory and probabilistic programming languages.


## Summarize the paper in two paragraphs.

 Here is a two paragraph summary of the paper:

The paper introduces quasi-Borel spaces, a new type of mathematical space that supports higher-order functions and probability distributions. Quasi-Borel spaces are designed to overcome limitations of standard measurable spaces, which do not handle higher-order functions well. A quasi-Borel space is defined in terms of random variables instead of directly through measurable subsets. 

The authors show that the category of quasi-Borel spaces is cartesian closed, meaning it supports higher-order functions. There is a natural notion of probability measure on these spaces, and the space of all probability measures forms the basis of a probability monad. This provides a foundation for probabilistic programming languages. The usefulness of quasi-Borel spaces is demonstrated through applications including Bayesian regression, a reformulation of the randomization lemma, and a generalized version of de Finetti's theorem holding for all quasi-Borel spaces. Overall, the paper introduces quasi-Borel spaces as a convenient category for higher-order probability theory.


## Summarize the main method used in the paper in one paragraph.

 The paper introduces quasi-Borel spaces as a new foundation for higher-order probability theory. The main method used is to start with the standard notion of measurable space, but shift the emphasis from measurable subsets to random variables. Specifically, a quasi-Borel space is a set X equipped with a collection of functions from the reals R to X, satisfying certain closure conditions. This allows constructing a cartesian closed category where one can interpret terms involving both higher-order functions and probability distributions. Key results include:

- Showing quasi-Borel spaces form a well-pointed cartesian closed category, supporting function spaces unlike regular measurable spaces. This provides semantics for higher-order probabilistic programs.

- Defining probability measures and integration on quasi-Borel spaces, generalizing the standard notions on measurable spaces. The space of probability measures itself forms a quasi-Borel space, giving a probability monad.

- Using the higher-order structure to give conceptually cleaner statements of results like the randomization lemma and de Finetti's theorem. 

So in summary, the main method is a conceptual shift to random variables as primitive rather than measurable subsets, yielding a workable higher-order probability theory. The quasi-Borel space definition and its categorical properties are technically simple, but provide a convenient foundation for probabilistic semantics.


## What is the central research question or hypothesis that this paper addresses?

 Based on my reading, the central research question of this paper is: 

How can we develop a foundation for higher-order probability theory that accommodates both continuous probability distributions and higher-order functions?

The standard measure-theoretic foundation of probability theory using measurable spaces does not handle higher-order functions well, since the category of measurable spaces is not cartesian closed. This makes it difficult to formalize and reason about sophisticated probabilistic models that use higher-order functions, like those expressed in probabilistic programming languages. 

The paper introduces the notion of "quasi-Borel spaces" as a new foundation that supports both continuous probability distributions and higher-order functions. The key properties highlighted are:

- The category of quasi-Borel spaces is cartesian closed, allowing higher-order functions.

- There is a natural notion of probability measure on quasi-Borel spaces. The space of all probability measures also forms a quasi-Borel space, giving a commutative monad.

- Quasi-Borel spaces conservatively extend standard Borel spaces, inheriting good properties, while also supporting the higher-order structure needed.

The paper aims to demonstrate the utility of this new foundation through examples like Bayesian regression, rephrasing a randomization lemma, and generalizing de Finetti's theorem to quasi-Borel spaces. Overall, it makes the case that quasi-Borel spaces provide a convenient category for higher-order probability theory.


## What problem or question is the paper addressing?

 The paper introduces quasi-Borel spaces as a new foundation for higher-order probability theory and probabilistic programming languages.  The key issue it aims to address is that standard probability theory and measurable spaces do not adequately support higher-order functions, as evidenced by the fact that the category of measurable spaces is not cartesian closed. However, probabilistic programming languages allow the use of higher-order functions in combination with probability distributions. So the goal of the paper is to develop a new categorical setting that supports both higher-order functions and probability theory.

The key contributions and innovations of the paper are:

- Introducing the notion of quasi-Borel space, where randomness comes from the real numbers. This shifts the focus from measurable subsets to random variables.

- Showing that the category of quasi-Borel spaces is cartesian closed, unlike measurable spaces, and therefore supports higher-order functions.

- Defining probability measures and a probability monad on quasi-Borel spaces.

- Demonstrating the utility of quasi-Borel spaces for probabilistic programming via examples like Bayesian regression and rephrasing the randomization lemma. 

- Proving that key results like de Finetti's theorem hold more generally for quasi-Borel spaces compared to arbitrary measurable spaces.

Overall, the paper puts forward quasi-Borel spaces as a convenient new foundation for probability theory and semantics of probabilistic programming languages, with advantages over standard measurable spaces.
