# [Unifying Invariance and Spuriousity for Graph Out-of-Distribution via   Probability of Necessity and Sufficiency](https://arxiv.org/abs/2402.09165)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Graph neural networks (GNNs) assume test and training graph data are independently and identically distributed (IID). However, this assumption often does not hold in real-world scenarios, leading to an out-of-distribution (OOD) challenge.
- Existing methods address this by extracting invariant features using environment augmentation. But they have difficulties finding the ideal invariant subgraphs due to needing to trade-off between invariant alignment and prediction accuracy.

Proposed Solution:  
- The paper proposes a unified framework called PNSIS that leverages Probability of Necessity and Sufficiency (PNS) theory to extract invariant substructures.
- It involves a PNS invariant subgraph extractor that optimizes an upper bound defined using PNS to extract necessary and sufficient invariant subgraphs.
- It also uses a spurious subgraph classifier and ensembles it with the invariant subgraph classifier to enhance robustness and performance.

Main Contributions:
- Provides a theoretical analysis that shows invariant subgraphs can be extracted by minimizing a PNS upper bound.
- Proposes the PNSIS framework that unifies invariant subgraph learning via PNS theory and exploitation of spurious subgraphs.  
- Achieves state-of-the-art performance on several graph OOD benchmarks, demonstrating effectiveness for real-world applications.
- Provides interpretability via visualizations of extracted invariant subgraphs.

In summary, the paper makes notable contributions in addressing graph OOD via a novel approach of unifying invariance and spuriousness based on PNS theory and an ensemble method. Experiments validate its effectiveness.
