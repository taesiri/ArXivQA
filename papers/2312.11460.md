# [Hybrid Internal Model: A Simple and Efficient Learner for Agile Legged   Locomotion](https://arxiv.org/abs/2312.11460)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Robust locomotion control of legged robots depends on accurate state estimation. However, most legged robots have only partial and noisy onboard sensor observations, making it challenging to estimate external states like terrain properties. Prior methods use a two-stage approach - first train an oracle policy with full state information, then transfer it using mimicking. This causes performance loss and constraints further optimization.

Method: 
The paper proposes a Hybrid Internal Model (HIM) within a model-based reinforcement learning framework to estimate external disturbances from the robot's response. HIM consists of two components:
1) Velocity estimation that tracks commanded velocity 
2) Implicit stability representation optimized via contrastive learning to be close to future states.  

Together they form a hybrid internal embedding that captures explicit velocity tracking and implicit stability maintenance goals. HIM uses proprioception from joint encoders and IMU as input. The embedding is optimized via Hybrid Internal Optimization and used with partial observations to train a policy network with PPO.

Benefits:
- Only uses onboard proprioceptive sensors 
- Avoids info loss in mimicking methods
- More sample efficient due to batch-level optimization
- More robust to noise via contrastive learning
- Lightweight and platform-agnostic

Results: 
- Outperforms prior methods on various terrains and disturbances in simulation and real-world
- Generalizes to unseen environments like stairs, payloads, hits, missing steps etc.
- Converges in 200M samples and 1 hour on an RTX 4090 GPU
- Deployed on Unitree A1, Aliengo and Go1 robots

Main contributions:
1) A new perspective connecting classical control concepts with learning for state estimation
2) An efficient way to leverage batch-level information in locomotion tasks 
3) State-of-the-art performance using only onboard sensors
4) Excellent generalizability to diverse disturbances with fast convergence
