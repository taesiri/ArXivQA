# DeepFace-EMD: Re-ranking Using Patch-wise Earth Mover's Distance   Improves Out-Of-Distribution Face Identification

## What is the central research question or hypothesis that this paper addresses?

Based on my reading, the central hypothesis of this paper is that re-ranking face identification results using patch-wise Earth Mover's Distance (EMD) similarity can improve precision on out-of-distribution face images containing occlusions or perturbations. The key ideas are:- Traditional face identification uses cosine similarity between image embeddings, which can fail on new types of test images not seen during training.- The authors propose a 2-stage approach: first retrieve top candidates using image embeddings, then re-rank them by comparing patch-level embeddings between the query and candidates using EMD.- EMD compares two sets of weighted features (image patches) by finding the optimal flows between them. This allows matching images based on fine-grained correspondence of facial parts like eyes, nose, etc.- Re-ranking with EMD consistently improves precision on challenging out-of-distribution face images - those with masks, sunglasses, crops, rotations, or adversarial perturbations.- The improvements hold across different models (ArcFace, FaceNet, CosFace) without retraining them, demonstrating the broad usefulness of EMD for face identification.In summary, the central hypothesis is that leveraging EMD to compare faces at a patch-level can make face identification more robust to out-of-distribution test cases where traditional methods fail. The experiments support this hypothesis across diverse scenarios.


## What is the main contribution of this paper?

Based on my reading of the paper, the main contributions appear to be:1. Proposing a 2-stage hierarchical approach for face identification that first compares images at a coarse, global level using cosine distance, and then re-ranks the top candidates using a fine-grained, patch-level comparison with Earth Mover's Distance (EMD). 2. Demonstrating the effectiveness of the approach on improving face identification accuracy, especially for challenging out-of-distribution query images containing occlusions, cropping, or adversarial perturbations. The method is shown to improve precision consistently across three pre-trained models (ArcFace, FaceNet, CosFace) without any finetuning.3. Conducting thorough ablation studies to analyze different design choices such as feature weighting techniques for EMD and combining EMD with cosine similarity. Finding interesting insights such as uniform weighting and using global average pooling features being most effective for face images.4. Comparing the approach to finetuning on augmented masked data and showing the re-ranking rivals finetuning without requiring extra training data.5. Providing intuitive visualizations of the patch-wise similarity using "flow" images that help explain why the re-ranking improves accuracy in occluded cases.In summary, the key novelty appears to be in effectively harnessing EMD to compare face images in a hierarchical manner at both global and local patch levels, yielding improved out-of-distribution robustness and interpretability without retraining models. The ablation studies also provide useful insights on applying EMD specifically for face identification task.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

Here is a one sentence summary of the paper:The paper proposes a new two-stage face identification method that re-ranks gallery candidates based on patch-wise similarity using Earth Mover's Distance, achieving improved precision on challenging out-of-distribution queries like masked, cropped, or adversarial faces.


## How does this paper compare to other research in the same field?

Here are some key ways this CVPR 2022 paper compares to other related work on face identification and verification:- It proposes a new 2-stage approach to face identification that first retrieves candidate faces using a standard cosine similarity on image embeddings, and then re-ranks them using Earth Mover's Distance (EMD) on patch embeddings. This hierarchical comparison of faces is novel.- The paper demonstrates the effectiveness of EMD for re-ranking faces and handling occluded/out-of-distribution queries. Prior work has not explored EMD much for deep face recognition. The most related is concurrent work on using EMD for image retrieval in DIML [49]. - Unlike most prior work that aims to improve robustness to occlusion via finetuning or data augmentation, this paper shows accuracy gains from simply re-ranking with EMD, without any re-training.- It provides an extensive ablation study on different patch weighting schemes for EMD in face identification. It finds uniform weighting often works best, unlike some findings in other domains [48,49].- The paper shows consistent gains across multiple pre-trained models (ArcFace, FaceNet, CosFace), demonstrating generality of the approach.- The method achieves state-of-the-art results on the MLFW face verification benchmark [58], when combined with existing models.- The work focuses on face identification and verification. Most EMD image retrieval works have been on more general domains like birds, cars [48,49]. Faces have unique properties like aligned crops and saliency of local patches.In summary, this paper presents a thorough investigation of EMD for improving deep face recognition, especially under occlusion and out-of-distribution scenarios. The hierarchical comparison and patch weighting analysis are novel contributions.
