# [GVFs in the Real World: Making Predictions Online for Water Treatment](https://arxiv.org/abs/2312.01624)

## Write a very high-quality paragraph summarizing the paper that effectively covers the paper.

 Here is a summary paragraph of the key points from the paper:

This paper investigates using reinforcement learning prediction methods, specifically temporal difference (TD) learning, to make accurate multi-step predictions on real data from a drinking water treatment plant. The data exhibits complex properties like seasonality, sensor drift, and mode changes, making prediction challenging. The authors construct an approximate state to deal with partial observability, using a simple trace-based memory. They then compare predictions encoded as general value functions (GVFs), which are exponentially discounted sums of future observations, to classical n-step predictions from time series analysis. They find that with suitable pre-training on historical data and online updating, the TD agent achieves lower error overall compared to n-step predictions. Finally, they highlight the importance of online learning, showing a TD agent that updates predictions continually in deployment significantly outperforms a fixed predictor trained only on historical data. The work provides practical insights on designing predictive systems for industrial applications that must operate continually in complex, non-stationary environments.


## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem: 
The paper investigates using reinforcement learning (RL) based prediction methods for optimizing and eventually automating operations in a real-world drinking water treatment plant. Developing an accurate prediction system is an important first step before optimization and automation can be achieved. However, predicting water treatment data is challenging due to its high dimensionality, noise, partial observability, seasonality, non-stationarity, heterogeneity across sensors, and different operating modes of the plant.

Proposed Solution:
The paper proposes using General Value Functions (GVFs), which make temporally-extended predictions by estimating discounted sums of future sensor values. GVFs can be learned incrementally via temporal difference (TD) learning, allowing online adaptation in deployment. The predictions are made using a neural network that takes as input an augmented observation vector summarizing sensor data and domain knowledge about plant modes and time of day. The TD agent is first pre-trained on historical offline data to initialize the parameters. It is then fine-tuned online as new data arrives to track distribution shifts.

The paper also compares GVF predictions to classical n-step predictions from time series forecasting. It validates the methods on real data from a water treatment plant over multiple time periods. Hyperparameters like learning rates are selected automatically using a validation set that mimics the online setting.

Main Contributions:

- Provides analysis of a year's worth of high frequency (1 Hz) data from a real water treatment plant, characterizing properties like seasonality, sensor drift, mode changes, etc. that make prediction challenging

- Demonstrates that neural network based GVF predictions, learned via TD, can accurately anticipate future pressure and temperature values around 100 seconds ahead during online deployment

- Shows GVF predictions have lower error than n-step predictions in this domain, while allowing fully incremental learning

- Reveals that online updating during deployment significantly improves over just offline pre-training, highlighting importance of adaptivity for non-stationary systems

- Offers insights into designing learning systems for real-world applications, like using offline data for pre-training and hyperparameter tuning

In summary, the paper presents a feasibility study applying RL-based prediction techniques to real water treatment data. The promising accuracy of the learned GVF predictions sets the foundation for future work on optimization and control.
