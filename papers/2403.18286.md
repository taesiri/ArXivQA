# [Few-Shot Recalibration of Language Models](https://arxiv.org/abs/2403.18286)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Language models (LMs) can appear well-calibrated on aggregate distributions, but are miscalibrated on narrower slices/domains within that distribution. For example, an LM could be perfectly calibrated on a mixture of math, history and science questions, but significantly miscalibrated on just math questions alone.

- This is a key problem because in practice, users query LMs from narrow slices rather than broad distributions. So slice-specific miscalibration needs to be addressed.

Proposed Solution:
- The paper proposes a framework for few-shot, slice-specific recalibration of LMs. 

- A separate recalibration model is trained to take as input a small number of unlabeled examples from a slice, and output a precision curve that maps confidence scores to accuracy on that slice.

- The recalibrator is trained on synthetic slices constructed by mixing labeled domains from existing datasets in different combinations. This allows it to generalize to new slices.

- At test time, the recalibrator takes as input just a few unlabeled examples from a slice, and predicts a precision curve to recalibrate the LM specifically for that slice.

Main Contributions:
- Formalizes the problem of slice-specific miscalibration of LMs hidden by aggregate calibration.

- Proposes a new framework, methodology and model for few-shot, slice-specific recalibration using only unlabeled data.

- Achieves state-of-the-art performance in recalibrating large LMs like PaLM and LLaMA for finer-grained slices on benchmarks like MMLU and XNLI.

- Enables downstream tasks like finding optimal confidence thresholds for precision control and reducing calibration error per slice.
