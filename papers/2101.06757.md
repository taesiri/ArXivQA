# [Higher Order Automatic Differentiation of Higher Order Functions](https://arxiv.org/abs/2101.06757)

## What is the main contribution of this paper?

Based on my reading, the main contributions of the paper seem to be:1. Providing a denotational semantics for a higher order language with variants and inductive types (like lists) using diffeological spaces. This semantics guarantees that all definable functions are smooth (infinitely differentiable).2. Defining a syntactic forward-mode automatic differentiation translation on the language that can compute higher order derivatives.3. Proving the correctness of the automatic differentiation translation with respect to the denotational semantics using a logical relations argument. This shows the differentiation translation computes mathematically correct derivatives. 4. Giving a categorical analysis of the correctness argument in terms of syntactic categories and a "gluing" construction on diffeological spaces.5. Extending the correctness result to all first order types using manifolds and jet bundles from differential geometry.6. Providing a discussion about the non-uniqueness of derivatives for higher order functions in this framework and relating it to notions of derivatives studied in differential geometry.In summary, the main contribution seems to be providing a denotational semantics for differentiable programming languages that supports correctness proofs for automatic differentiation, including at higher types. The categorical analysis and connections to differential geometry also seem novel.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

Here is a one sentence summary of the paper:The paper presents semantic correctness proofs of automatic differentiation methods on a higher order language with algebraic data types, using diffeological spaces to model smoothness and a gluing construction to simultaneously interpret programs and their derivatives.


## How does this paper compare to other research in the same field?

Based on my reading of the abstract, here are a few ways this paper relates to other research on automatic differentiation:- It provides semantic correctness proofs for automatic differentiation methods, especially focusing on higher order methods that compute higher derivatives. This adds to existing work that studies verification of AD from an operational semantics perspective.- It uses diffeological spaces as the model to interpret the programming language and prove correctness. This provides a denotational semantics approach to reasoning about smoothness and derivatives. Other recent work has used more traditional models like manifolds. - It proposes a new "gluing" construction to model relations between programs and their derivatives. This helps resolve issues around defining derivatives of higher order functions. The gluing idea seems related to other categorical treatments of logical relations.- It aims to handle a language with higher order functions and algebraic data types. Extending AD to these language features has been an active research direction. Related papers have studied linear type systems or reverse mode AD on functional languages.- For higher derivatives, it connects to mathematical work on Taylor approximations and jet bundles. This makes contact with "Taylor mode AD" methods used in some implementations.Overall, the paper seems to blend semantic/categorical techniques with practical language considerations relevant to AD. It makes theoretical contributions around modeling derivatives, especially at higher types, while keeping implications for real AD tools in view. Situating the work among other AD research, those seem like some of its notable features. But I'd be interested to hear others' more expert takes!


## What future research directions do the authors suggest?

Based on my reading of the paper, some key future research directions suggested by the authors include:- Extending the analysis to cover array types instead of just tuples for representing vectors. The authors note this is important for scalability and efficiency in practice.- Developing efficient implementations of the higher-order AD methods, by adapting techniques like those used in efficient first-order AD libraries. This includes optimizations like algebraic simplification, partial evaluation, and compiling to efficient target code. - Exploring reverse mode AD and mixed forward/reverse mode AD at higher types. The authors have correctness proofs for forward mode AD, but many applications require reverse mode. Extending the analysis to reverse mode is noted as important future work.- Analysing AD for other programming language features like recursion, iteration, probabilistic programming, and partial/non-smooth functions. The authors have shown how to extend their semantic analysis to some of these, but others remain as interesting open problems.- Exploring more intentional models of higher-order functions, such as game semantics, to find canonical or "best" notions of derivative at higher types. The paper notes the semantics they use does not privilege any one derivative, but finding canonical derivatives may be useful. - Connecting the semantic analysis more closely to details of practical AD systems and implementations, to help guide the design of new AD tools.- Extending the analysis to other forms of differential programming, like neural differential equations and physics-informed machine learning.So in summary, the key suggestions are around extending the theoretical semantic analysis to cover more language features, developing more efficient implementations, finding canonical higher-order derivatives, and connecting the theory better to practical systems. Analyzing newer differential programming paradigms is also noted as an interesting direction.


## Summarize the paper in one paragraph.

Here is a one paragraph summary of the paper:The paper presents semantic correctness proofs of automatic differentiation (AD) methods. It considers a forward-mode AD macro on a higher order language with algebraic data types and characterizes it as the unique structure preserving macro given a choice of derivatives for basic operations. A rich semantics for differentiable programming is described based on diffeological spaces which interprets the language. The paper shows what it means for the AD method to be correct with respect to this semantics. An elegant semantic proof of correctness is provided based on a gluing construction on diffeological spaces, which is essentially a logical relations argument. The analysis is shown to extend to AD methods for computing higher order derivatives using Taylor approximations.


## Summarize the paper in two paragraphs.

Here is a two paragraph summary of the paper:The paper presents semantic correctness proofs of automatic differentiation (AD) methods. The authors consider a forward-mode AD translation on a higher order language with algebraic data types. They characterize the AD translation as the unique structure preserving macro that is given a choice of derivatives for basic operations. A rich semantics for differentiable programming is described based on diffeological spaces that can interpret the language. The correctness of the AD translation is phrased with respect to this semantics. An elegant semantic proof of correctness for the AD translation is presented based on a gluing construction on diffeological spaces. This is essentially a logical relations argument. The analysis is shown to extend to AD methods that compute higher order derivatives using Taylor approximations.In summary, the paper provides a semantic framework based on diffeological spaces to model differentiable programming languages. This allows defining a compositional semantics for programs involving higher order functions. A forward automatic differentiation translation is defined and shown to be correct using a gluing construction, which corresponds to a logical relations argument. The AD translation and correctness proof are generalized to compute higher order derivatives via Taylor approximations. The key contribution is a denotational understanding of AD on languages with higher order functions, along with an elegant semantic correctness argument.


## Summarize the main method used in the paper in one paragraph.

Here is a one paragraph summary of the main method used in the paper:The paper presents semantic correctness proofs of automatic differentiation (AD) using diffeological spaces as a denotational semantics. It considers a forward-mode AD method on a higher order language with algebraic data types. The AD method is characterized as the unique structure preserving functor given a choice of derivatives for basic operations. The semantics is based on diffeological spaces which interpret the language and provide a notion of differentiability. The paper shows the AD method is correct by using a gluing construction on diffeological spaces, which essentially implements a logical relations argument. This correctness is shown to extend to AD methods computing higher order derivatives via Taylor approximations.
