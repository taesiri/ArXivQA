# [Towards an empirical understanding of MoE design choices](https://arxiv.org/abs/2402.13089)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement:
- Mixture of experts (MoE) models have shown exceptional performance, but the impact of different architectural choices is not well understood. Specifically, how do choices like routing unit (token vs sequence), routing strategy (layer-wise vs global), number of experts, and number of active experts impact validation performance and expert specialization?

- Prior works on expert specialization mostly use token-level routing and have shown evidence of syntactic specialization. This paper investigates if sequence-level routing can induce more context-dependent, topic-level specialization.  

Methodology:
- Perform ablation studies on GPT2 small models trained from scratch on Wikipedia (multilingual) and OpenWebText (English only) datasets.
- Vary routing unit (token vs sequence), routing strategy (layer-wise vs global), number of experts and number of active experts (K).
- Evaluate validation perplexity and analyze expert activation patterns on unseen domains.

Key Findings:  
- Token routing benefits more from increased number of experts, while sequence routing benefits more from increased number of active experts.  
- Layer-wise learned/frozen routing performs the best. Language-based global routing underperforms.
- Load balancing loss to prevent expert collapse is not needed. 
- Sequence routing shows signs of weak, topic-level expert specialization, unlike token routing.

Main Contributions:
- First systematic ablation study quantifying the impact of different MoE designs like routing unit, routing strategy etc. 
- Demonstrate different preferences for token vs sequence routing architectures.
- Provide evidence for feasibility of weak, topic-level expert specialization with sequence-level routing.

The paper offers useful insights into optimal choices when designing MoE architectures, especially highlighting differences between token and sequence routing.
