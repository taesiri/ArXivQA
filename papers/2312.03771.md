# [DreamInpainter: Text-Guided Subject-Driven Image Inpainting with   Diffusion Models](https://arxiv.org/abs/2312.03771)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
The paper introduces a new image inpainting task called "text-guided subject-driven image inpainting". The goal is to inpaint a masked region in an image by using both a text description to guide the content generation and an exemplar image to provide a reference for preserving subject identity. This is challenging since the model needs to balance using the text guidance to generate novel content while also accurately replicating details from the reference image. Prior work has only used text or images independently for inpainting.

Proposed Solution:
The paper proposes a two-step approach called DreamInpainter to address this task. 

First, dense subject features are computed from the exemplar image using the UNet encoder of a diffusion model. Then, a discriminative token selection module ranks and selects only the most informative tokens to avoid direct subject copying while preserving identity. 

Second, a decoupling regularization technique is introduced during training. Instead of only recovering the masked region, noise and losses are added to the entire image. This forces the model to rely more on the text captions to reconstruct lost details beyond just the subject features.

Main Contributions:
- Defines the novel problem setting of text-guided subject-driven image inpainting that utilizes both text and exemplars.
- Proposes the DreamInpainter approach with two main components - discriminative token selection and decoupling regularization.
- Token selection avoids direct subject copying for better editability while retaining identity. 
- Decoupling regularization enhances text guidance by preventing over-reliance on exemplars.
- Achieves superior quantitative and qualitative performance over existing inpainting methods that use only text or exemplars.
- Enables new applications like creative subject insertion and property transformations.

The key insight is to extract essential identity information from exemplars while promoting text guidance, made possible through the proposed techniques. Experiments validate DreamInpainter's ability to balance identity preservation and text alignment.
