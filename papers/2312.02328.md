# [Multi-Modal MPPI and Active Inference for Reactive Task and Motion   Planning](https://arxiv.org/abs/2312.02328)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
The paper addresses the challenge of executing task and motion plans (TAMP) reactively in the presence of uncertainties and disturbances during execution. Classical TAMP methods generate an open-loop plan that is executed without adaptations. However, real-world conditions like changing environments, inaccuracies, or external disturbances can easily invalidate the original plan. The paper argues that reactive TAMP necessitates the simultaneous adaptation of both high-level discrete actions and continuous low-level motions.

Proposed Solution:  
The paper proposes combining an Active Inference Planner (AIP) for high-level symbolic planning with a novel Multi-Modal Model Predictive Path Integral (M3P2I) controller for low-level motion control.

The key ideas are:

1) Enhance AIP to generate multiple alternative action plans to achieve a goal instead of a single plan. 

2) Propose a Multi-Modal MPPI (M3P2I) motion planner that can sample and evaluate in parallel these alternative plans. Each plan is linked to a cost function and the costs are used to compute optimal control inputs that blend the different strategies smoothly.

3) A plan interface to map symbolic actions to cost functions.


Main Contributions:

1) A new Multi-Modal MPPI (M3P2I) capable of sampling different plan alternatives in parallel, evaluating them against different costs, and blending solutions smoothly instead of switching heuristics.

2) An enhanced AIP planner capable of generating multiple alternative cost functions for M3P2I instead of a single plan.

The integrated framework allows simultaneous adaptation of high-level actions and low-level motions to reactively cope with disturbances and changing environments.

Experiments:
The approach is evaluated in two scenarios - a non-prehensile push/pull task and a reactive pick-and-place task. Results show the ability to complete tasks by blending skills (pushing/pulling) and grasping strategies (top/side grasp) that individual planners fail at. The method also outperforms an RL baseline at the cube stacking task when disturbances are introduced.
