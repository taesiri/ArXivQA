# [It's All About Your Sketch: Democratising Sketch Control in Diffusion   Models](https://arxiv.org/abs/2403.07234)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Existing sketch-to-image diffusion models struggle to generate high-quality images from real freehand amateur sketches, often producing distorted and non-photorealistic outputs. This stems from directly translating sketch contours into the output image domain (spatial conditioning), as well as a dependence on precise text prompts during inference. There is a trade-off between photorealism and sketch fidelity that requires meticulous tuning. The paper reaffirms these limitations through a pilot study on an existing model.

Proposed Solution:
The paper introduces an abstraction-aware framework to democratize sketch control, allowing amateur sketches to yield precise, photo-realistic images without text prompts during inference. This is achieved via three key components:

1) A sketch adapter that converts the input sketch into an equivalent fine-grained textual embedding to guide the diffusion model's denoising process through cross-attention. This avoids direct spatial conditioning.

2) Adaptive time-step sampling during diffusion based on a measure of the sketch's abstraction, emphasizing semantics for more abstract inputs. 

3) Discriminative guidance incorporated through a pre-trained fine-grained sketch-based image retrieval model to reinforce sketch-photo associations.

Although no text prompts are used during inference, synthetic captions are utilized during training to help learn the sketch adapter given limited sketch-photo data.

Main Contributions:
- Democratizing sketch control in diffusion models, allowing amateur sketches to yield accurate images through an abstraction-aware approach
- Introducing key components like a sketch adapter, adaptive sampling strategy and discriminative guidance to form an effective alternative to spatial conditioning and text prompts
- Extensive experiments validating the method's ability to generate high-fidelity, photo-realistic images guided only by freehand sketches during inference
