# [N-MPC for Deep Neural Network-Based Collision Avoidance exploiting Depth   Images](https://arxiv.org/abs/2402.13038)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Autonomous navigation and collision avoidance for aerial robots (UAVs) in unknown environments is challenging, especially at high speeds. Classical approaches rely on dense maps from heavy sensors like lidars, but these are costly and limit agility. Recent works use only onboard sensors like cameras for reactive avoidance, but struggle with the high-dimensional image data.

Proposed Solution: 
This paper proposes a nonlinear model predictive control (NMPC) framework that integrates a deep neural network (DNN) to process depth images for UAV collision avoidance. The DNN takes as input a depth image and 3D point, and outputs a collision score. It is composed of a variational autoencoder CNN that compresses the image into a latent vector, and a fully-connected network that scores 3D positions based on the latent vector. The DNN is embedded into the NMPC problem as an obstacle avoidance constraint over the prediction horizon. This enables the NMPC to avoid perceived obstacles in real-time based solely on depth images, without an explicit map.

Main Contributions:
- A DNN architecture designed specifically for efficient integration into a real-time NMPC for UAVs, that outputs a differentiable collision score for any 3D point based on a depth image
- Methodology to embed the DNN into the NMPC problem formulation as an algebraic constraint over the receding horizon
- Real-time implementation validated in simulations and experiments on a quadrotor with onboard sensing and computing
- Release of open-source code for the DNN, NMPC and interfaces

The approach achieves real-time obstacle avoidance on only an onboard depth camera, enabling agile flights. The NMPC leverages the prediction horizon for non-greedy maneuvers. The integration of learning-based perception with optimal control is a promising paradigm for autonomous UAV navigation.
