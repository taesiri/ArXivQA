# [Multistep Inverse Is Not All You Need](https://arxiv.org/abs/2403.11940)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Prior work proposed a "multi-step inverse" method (AC-State) to learn a low-dimensional "control-endogenous" state representation from high-dimensional observations in an MDP. This representation should capture all controllable dynamics but exclude irrelevant, "exogenous" factors. 
- However, the paper identifies cases where AC-State fails, either requiring exponentially more inverse prediction steps than claimed necessary, or failing completely on periodic dynamics.

Proposed Solution:
- The paper proposes a new method, ACDF, which augments AC-State's multi-step inverse loss with an additional "latent forward model" loss over the learned states. 
- ACDF provably learns an optimal control-endogenous state representation for a very broad class of MDPs, including those with periodic dynamics. It also gives a corrected bound on the number of inverse steps needed.

Key Contributions:
- Identifies fundamental limitations of purely multi-step inverse approaches like AC-State. Shows cases requiring exponentially more history, or where it fails completely.
- Introduces the concepts of "witness distance" and "enhanced exogenous states" to characterize controllable dynamics for analysis.
- Proves that ACDF, combining multi-step inverse and latent forward modeling, provably learns control-endogenous states under general assumptions.
- Empirically demonstrates limitations of AC-State and advantages of ACDF on tabular MDPs and visual navigation tasks.

In summary, the key insight is that supervision from both future observations (via inverse modeling) and immediate transitions (via forward modeling) is necessary and sufficient to extract latent controllable dynamics from irrelevant noise factors. The paper makes both theoretical and empirical contributions toward this understanding.
