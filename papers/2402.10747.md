# [Fully Differentiable Lagrangian Convolutional Neural Network for   Continuity-Consistent Physics-Informed Precipitation Nowcasting](https://arxiv.org/abs/2402.10747)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Precipitation nowcasting is important for early warning systems to mitigate damage from extreme weather events. Convolutional neural networks (CNNs) have become state-of-the-art but suffer from producing blurry forecasts over longer time horizons due to uncertainty. This limits their usefulness for predicting localized extreme events. 

- Recent work has shown that incorporating physics-based assumptions of fluid flow into CNN architectures, specifically by transforming the inputs into a Lagrangian reference frame, can produce less blurry and more useful forecasts. However, existing Lagrangian CNN models rely on costly optical flow algorithms during inference.

Proposed Solution:
- The authors propose LUPIN, a fully differentiable Lagrangian Double U-Net architecture for precipitation nowcasting. It consists of two U-Nets - one predicts an advection motion field and the other forecasts the evolution of precipitation intensity over time.

- A differentiable semi-Lagrangian scheme is used to transform inputs into Lagrangian coordinates based on the predicted motion field. This allows end-to-end training. The second U-Net sees inputs with motion "removed", helping it learn growth and decay patterns.

- Training is done in three stages - first the motion U-Net, then the forecasting U-Net with frozen motion weights, and finally fine-tuning the full model jointly. Loss functions incorporate domain knowledge of fluid flow physics.

Contributions:
- LUPIN matches the performance of prior Lagrangian CNN models without needing costly optical flow at inference time. This is achieved through the differentiable coordinate transform and learned motion field.

- The proposed architecture is flexible and could incorporate recent generative models to further improve precipitation nowcasting and prediction of extreme events.

- The work demonstrates the benefit of including physical assumptions within deep learning architectures and training schemes. This is an important direction to build more reliable models.
