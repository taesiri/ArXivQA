# [Robust Conformal Prediction under Distribution Shift via   Physics-Informed Structural Causal Model](https://arxiv.org/abs/2403.15025)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Conformal prediction (CP) provides prediction sets that cover the true label with at least $(1-\alpha)$ confidence, even when the marginal input distributions $P_X$ differ between calibration and test data. However, when the conditional label distributions $P_{Y|X}$ also differ, the coverage guarantee no longer holds. It is important to measure and minimize this coverage loss at all confidence levels under distribution shift.

Proposed Solution: 
1) Theoretically quantify coverage difference and calculate its upper bound based on the divergence between the cumulative density functions (CDFs) of calibration and test conformal scores.

2) Use Wasserstein distance to integrate the upper bound over all confidence levels to provide a comprehensive evaluation of domain adaptation generalization error of a conformal predictor.

3) Propose a physics-informed structural causal model (PI-SCM) to improve models' domain adaptation ability by capturing physical causality between variables. PI-SCM introduces more causality and thus reduces coverage divergence when test domain shifts.

Main Contributions:
1) Quantify coverage divergence and its upper bound using CDFs of conformal scores 

2) Apply Wasserstein distance as an integrator of coverage divergence over all confidence levels

3) Propose PI-SCM to reduce models' domain generalization error by capturing physical causality, thus improving coverage robustness

4) Validate PI-SCM can reduce coverage divergence and improve robustness in traffic speed and epidemic spread prediction tasks with real-world datasets

In summary, the paper provides a theoretical analysis of conformal prediction's coverage loss under distribution shift, and proposes PI-SCM to minimize this loss by capturing physical causality between variables. The effectiveness of PI-SCM is shown on real-world case studies.
