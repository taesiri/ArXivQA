# [The Heuristic Core: Understanding Subnetwork Generalization in   Pretrained Language Models](https://arxiv.org/abs/2403.03942)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement
- The paper investigates why neural networks like BERT generalize well in-domain but fail on out-of-distribution datasets, even after fine-tuning. 

Approach
- The authors fine-tune BERT models on MNLI and QQP and evaluate generalization by testing on HANS, PAWS-QQP. 
- They prune models to different sparsity levels and find subnetworks that perform similarly in-domain but differ significantly out-of-domain.
- This leads them to hypothesize the "Competing Subnetworks" idea - that models represent multiple disjoint solutions initially and generalization emerges from competition.  

Main Findings
- Contrary to the initial hypothesis, different subnetworks share a large overlap of components, with 9 attention heads common across all subnetworks. 
- These heads form a "heuristic core" that attends to simple features like token overlaps.
- Ablating these heads hurts out-of-distribution accuracy super-additively, suggesting the rest of the model relies on them.
- The effective size to approximate the model increases during training, opposed to decreasing as per the initial hypothesis.

Conclusions
- The heuristic core provides simple cues that the rest of the model builds on top of to ultimately generalize.
- There is no evidence for distinct competing subnetworks underlying generalization.
- Understanding the role of the shared low-level heuristic computations is an important direction for improving generalization.

The summary covers the key points about the problem being studied, the pruning-based approach, the main findings related to the "competing subnetworks" hypothesis, and the higher-level conclusions regarding the role of the heuristic core in generalization.
