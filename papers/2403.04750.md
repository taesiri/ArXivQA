# [JAX-SPH: A Differentiable Smoothed Particle Hydrodynamics Framework](https://arxiv.org/abs/2403.04750)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Particle-based fluid simulations using Smoothed Particle Hydrodynamics (SPH) are important tools for solving complex fluid dynamics problems. However, there is a lack of SPH frameworks compatible with modern deep learning frameworks to enable hybrid SPH-ML approaches.

- Existing differentiable fluid solvers like PhiFlow, JAX-CFD, JAX-Fluids use Eulerian (grid-based) methods rather than Lagrangian (particle-based) methods like SPH.

- Most existing SPH frameworks are optimized for high-performance computing rather than integration with ML and use low-level languages like C++/Fortran rather than Python. The few Python SPH frameworks lack easy compatibility with ML frameworks.

Proposed Solution:
- The paper proposes JAX-SPH, a differentiable SPH framework in Python based on JAX, enabling easy integration of SPH with machine learning.

- It extends the codebase from the LagrangeBench SPH dataset generation by adding more physics like the Transport Velocity formulation, Riemann Solver, Thermal Diffusion and validating them thoroughly.

- It restructures the code into a Python library and verifies gradient accuracy through the SPH solver using automatic differentiation.

Main Contributions:
- Development and validation of an open-source differentiable SPH solver in Python/JAX to bridge the gap between SPH simulations and machine learning.

- Enables applications like inverse design problems and Solver-in-the-Loop training by exposing accurate gradients through the SPH simulator.

- Showcases sample applications of the gradients - optimizing initial conditions to match final particle positions over 100 SPH steps, and temporal super-resolution using a learned model coupled with the SPH solver.

- Lays the foundation for future work on hybrid SPH-ML approaches like combining learned components with numerical SPH solvers.
