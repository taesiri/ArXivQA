# [Functorial String Diagrams for Reverse-Mode Automatic Differentiation](https://arxiv.org/abs/2107.13433)

## What is the central research question or hypothesis that this paper addresses?

Based on my reading, the main research contributions of this paper are:1. Developing a new calculus of hierarchical string diagrams suitable for representing closed monoidal (and cartesian closed) categorical structure. 2. Formulating and proving the correctness of an automatic differentiation algorithm for simply typed lambda calculus using this hierarchical string diagram calculus.3. Defining hierarchical hypergraphs called "hypernets" that provide a concrete representation of hierarchical string diagrams amenable to implementation via graph rewriting.More specifically, some key aspects of the research presented:- The paper introduces a formal language of hierarchical string diagrams that can represent abstraction via nested diagrams. This provides a graphical syntax for cartesian closed categories.- An automatic differentiation algorithm is presented that operates on hierarchical string diagrams. The algorithm's correctness for first-order terms is proven using the properties of reverse derivative categories. - Hierarchical hypergraphs called hypernets are defined and shown to be a sound and complete representation of hierarchical string diagrams. This enables implementing the AD algorithm via double-pushout graph rewriting.So in summary, the core hypothesis is that hierarchical string diagrams provide a suitable graphical language for formulating and proving correct an AD algorithm, and that hypernets give a representation allowing efficient implementation. The contributions provide evidence for this claim.


## What is the main contribution of this paper?

Based on my understanding, the main contributions of this paper are:1. It develops a new hierarchical string diagram calculus suitable for representing closed monoidal (and cartesian closed) categorical structure. This provides a convenient graphical language for reasoning about concepts like abstraction and application.2. It formulates an automatic differentiation algorithm for applied simply typed lambda calculus in this hierarchical string diagram language. This is based on the influential reverse mode AD algorithm of Pearlmutter & Siskind 2008, but proves its soundness for the first time. 3. It defines a class of hierarchical hypergraphs called "hypernets" that provide a sound and complete representation of hierarchical string diagrams. This allows the AD algorithm to be implemented via efficient double pushout graph rewriting of hypernets.In summary, the paper introduces an innovative hierarchical string diagram language that enables clearer formulation and soundness proof of a higher-order reverse mode AD algorithm, along with a graph rewriting representation to enable efficient implementation. The combination of these three topics showcases the value of hierarchical string diagrams and hypergraphs for reasoning about and implementing sophisticated program transformations like automatic differentiation.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

Here is a one sentence summary of the key points in the paper:The paper introduces a hierarchical calculus of string diagrams to formulate and prove correct an automatic differentiation algorithm, with applications to machine learning, and shows how to efficiently implement it via hierarchical hypergraph rewriting.


## How does this paper compare to other research in the same field?

Here are some thoughts on how this paper compares to other related research:- The use of hierarchical string diagrams to represent monoidal closed/cartesian closed structure seems novel. Previous work on string diagrams for closed categories like Baez and Stay's "Physics, Topology, Logic and Computation" focused more on compact closed categories. This paper provides the first fully detailed hierarchical string diagram calculus for cartesian closed categories.- The algorithm for automatic differentiation of higher-order terms is clearly inspired by and simplifies Pearlmutter and Siskind's seminal work on reverse-mode AD for functional programs. However, it focuses just on a simply-typed calculus without effects or recursion. Compared to other recent work on AD correctness like Vakar's, it has a simpler treatment of function space tangents.- Representing hierarchical string diagrams as hypergraphs/hypernets builds on a line of work connecting string diagrams and graph rewriting, like the seminal papers of Bonchi et al. But the specifics of the hierarchical hypergraph representation seem novel, as do the theorems connecting equivalence of string diagrams and isomorphism of hypernets.- The overall combination of using hierarchical string diagrams both to design the AD algorithm and prove it correct seems innovative. Previous work on AD correctness relied more on semantic models and denotational proofs. The graphical proofs here feel more intuitive. - Compared to related graphical languages for calculi with explicit substitutions like sharing graphs, string diagrams are more syntactic/algebraic and less focused on implementation concerns like cost models.So in summary, while the paper leverages a lot of related work, the specific hierarchical string diagram calculus, the simplicity of the graphical AD algorithm and proofs, and the hypernet representation all seem like novel contributions advancing the state of the art. The unification of graphical reasoning about AD, explicit substitutions, and graph rewriting is creative.
