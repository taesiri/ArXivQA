# [ALTO: An Efficient Network Orchestrator for Compound AI Systems](https://arxiv.org/abs/2403.04311)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Compound AI systems like pipelines of language models are becoming more complex and need to be served efficiently at scale. 
- Generative language models produce outputs incrementally token-by-token. This provides an opportunity to stream intermediate outputs between pipeline stages to reduce latency and increase throughput. 
- However, streaming introduces new challenges around correctness when some stages are stateful and need to aggregate over partial outputs, and around load balancing when different prompts generate varying amounts of outputs.

Proposed Solution:
- The authors propose ALTO, a network orchestrator to address the challenges with streaming compound AI pipelines.
- ALTO provides an "aggregation-aware routing" interface to express routing constraints for stateful stages that need to aggregate partial outputs. This ensures correctness.
- ALTO also proposes "distributed prompt-aware scheduling" to handle the diverse resource consumption of different prompts and maximize prompt locality across instances.

Contributions:
- Empirically demonstrate streaming provides up to 3x higher throughput and 1.8x lower tail latency on a pipeline.
- Identify and analyze novel challenges with streaming - correctness for stateful aggregation, and load balancing across diverse prompts. 
- Propose aggregation-aware routing interface in ALTO system to address correctness.
- Motivate need for and provide ideas on distributed prompt-aware scheduling to optimize load balancing.

In summary, the paper makes a case for streaming architectures for compound AI systems using partial outputs from language models, while highlighting and providing initial solutions for new correctness and load balancing problems that emerge as a result.
