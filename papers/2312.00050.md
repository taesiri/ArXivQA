# [Elijah: Eliminating Backdoors Injected in Diffusion Models via   Distribution Shift](https://arxiv.org/abs/2312.00050)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Diffusion models (DMs) have become state-of-the-art generative models due to their ability to generate high-quality images from noise without adversarial training. However, recent studies have shown that they are vulnerable to backdoor attacks. Existing backdoor defenses designed for classifiers are not suitable for DMs. There is a need for effective backdoor detection and removal techniques tailored for DMs.

Proposed Solution:
The paper proposes Elijah, the first backdoor detection and removal framework for DMs. The key insight is that existing attacks inject a distribution shift in the DMs which gets activated by the trigger. Leveraging this, Elijah performs the following:

1. Trigger Inversion: Inverts a potential trigger based on a distribution shift preservation property along the diffusion chain.

2. Backdoor Detection: Uses the inverted trigger to detect backdoor. Feeds inputs stamped with inverted trigger to DM and measures consistency of generated images using a proposed uniformity score and noise level using TV loss. Models detected as backdoored if consistency is high and noise is low.

3. Backdoor Removal: Reduces distribution shift against inverted trigger to eliminate backdoor. Uses a loss function that aligns distributions for trigger inputs and clean inputs while maintaining distribution on clean inputs learned from full clean data.


Main Contributions:

- First backdoor detection and removal framework tailored for DMs 

- Distribution shift preservation based trigger inversion method

- Uniformity score to measure consistency of images for backdoor detection

- Backdoor removal via distribution shift reduction while preserving benign utility

- Evaluation on 151 clean and 296 backdoored DMs of 3 types, 13 samplers and 3 attacks shows close to 100% detection accuracy and near complete backdoor removal with minimal impact on model utility

The framework does not require any real clean data, making it highly practical.
