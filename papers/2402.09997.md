# [LoraRetriever: Input-Aware LoRA Retrieval and Composition for Mixed   Tasks in the Wild](https://arxiv.org/abs/2402.09997)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Large language models (LLMs) benefit from parameter-efficient fine-tuning methods like Low-Rank Adaptation (LoRA) which are modular and plug-and-play. However, existing works utilize multiple LoRAs by either focusing on isolated downstream tasks or fixing LoRA selection during training. 
- This fails to address real-world scenarios where LLMs receive diverse prompts covering different tasks and the candidate LoRAs pool is dynamically updated.

Proposed Solution:
- The paper proposes LoraRetriever, a retrieve-then-compose framework to adaptively retrieve and compose LoRAs tailored to input prompts in mixed-task scenarios.

Key Components:
1) Input-aware LoRA Retrieval: Retrieves relevant LoRAs using sentence embeddings refined by instruction fine-tuning for effective generalization.

2) LoRA Composition: Employs two strategies - Fusion (averages parameters of retrieved LoRAs) and Mixture (averages outputs of each LoRA's submodules).

3) Efficient Batch Inference: Constructs a unique mapping matrix to activate corresponding LoRAs for each sample, allowing batched processing.

Main Contributions:  
- Proposes a flexible framework to leverage multiple LoRAs in dynamic mixed-task scenarios through adaptive retrieval and composition.
- Achieves robust generalization capability where retriever is trained on 40% tasks yet effectively handles unseen tasks.
- Enables tailored and efficient batch processing of heterogeneous requests.
- Outperforms baselines on mixed-task evaluation, proving effectiveness and versatility.

Let me know if you need any clarification or have additional questions on the key points! I'm happy to provide more details.
