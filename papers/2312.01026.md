# [Token Fusion: Bridging the Gap between Token Pruning and Token Merging](https://arxiv.org/abs/2312.01026)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Vision transformers (ViTs) offer flexibility for computer vision tasks but have high computational costs, limiting deployment on edge devices. 
- Prior work on efficient ViTs focuses on approximating the attention mechanism, but does not address the overall number of tokens.
- Recently, token pruning and token merging have emerged as ways to reduce tokens. However, pruning risks losing information and merging relies on functional linearity of model layers.

Proposed Solution - Token Fusion (ToFu):
- Combines the strengths of pruning and merging based on the functional linearity of each layer.  
- Uses pruning in early layers with low functional linearity to avoid issues from input interpolation.
- Transitions to a new merging approach called MLERP in later more linear layers. MLERP preserves feature norms compared to average merging.
- Overall, ToFu dynamically selects pruning or merging per layer to optimize accuracy and efficiency.

Main Contributions:
- Introduction of ToFu, which adapts pruning versus merging based on functional linearity of each layer
- Presentation of MLERP merging to address limitations of average merging by preserving feature norms
- Empirical validation showing ToFu outperforms standalone pruning and merging for ImageNet classification and Stable Diffusion image generation
- Demonstration of accuracy and speed advantages from ToFu across various vision transformer sizes

In summary, this paper makes key contributions in efficiently reducing tokens in ViTs by judiciously combining pruning and an enhanced merging approach based on properties of each layer. Experiments underscore ToFu's capabilities for deploying ViTs effectively on edge devices.
