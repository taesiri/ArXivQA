# [A Hierarchical Nearest Neighbour Approach to Contextual Bandits](https://arxiv.org/abs/2312.09332)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement:
The paper considers the contextual bandit problem in metric spaces under a fully adversarial setting. The goal is to design an algorithm that achieves low regret against any policy or adversary. A previous algorithm called Nearest Neighbour Bandits (NNB) achieved good regret when contexts are clustered, but performed poorly when many contexts lie near the decision boundary. This is the key limitation the current paper aims to address.

Proposed Solution: 
The paper proposes a new algorithm called Hierarchical Nearest Neighbour Approach (HNN). HNN is based on the Contextual Best of Neighbours (CBNN) meta-algorithm from the NNB paper. The key idea in HNN is to construct an online hierarchical partitioning of the observed contexts into different "levels". On each trial, it runs nearest neighbour search on contexts at each level of the hierarchy. The algorithm then cleverly combines the nearest neighbours from different levels to pick the action. 

This hierarchical structure allows HNN to eliminate the limitation of NNB on contexts near decision boundaries. Specifically, HNN can exclude any set of "margin" contexts near boundaries when computing the regret. This leads to greatly improved performance over NNB when many contexts lie in margins.

Main Contributions:

- Proposes the novel HNN algorithm for contextual bandits that constructs a hierarchical partitioning of contexts in an online fashion

- Provides regret analysis showing that HNN can exclude any set of margin contexts when bounding regret. This helps overcome limitations of prior NNB algorithm.

- Inherits extreme computational efficiency of NNB, with polylogarithmic runtime due to the CBNN meta-algorithm.

- Demonstrates concrete examples where HNN improves significantly over NNB when there are many contexts near decision boundary.

In summary, the key contribution is the HNN algorithm that cleverly utilizes hierarchy and exclusion of margin contexts to advance the state-of-the-art in efficient contextual bandits under adversarial settings.
