# [Detection and prediction of clopidogrel treatment failures using   longitudinal structured electronic health records](https://arxiv.org/abs/2310.08757)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Adverse drug reactions (ADRs) and treatment failures (TFs) from inadequate drug concentrations significantly impact patients and the healthcare system. There is a need to better predict ADRs/TFs.
- The paper focuses on building models to automatically detect and predict treatment failures with clopidogrel, a commonly prescribed blood thinner. Clopidogrel responses vary between patients and can lead to recurrent thrombosis or bleeding emergencies if concentrations are too low or high.

Proposed Solution:
- Leverage structured EHR data, including diagnoses, procedures and prescriptions records over time. Model the longitudinal records as clinical timelines. 
- Apply natural language processing techniques used on textual data to the structured timeline data. Compare recurrent networks (GRU, LSTM) and contextual models like BERT.
- Frame the problem as both a detection task (predicting failures in the year after first prescription) and prediction task (predicting failures from data before first prescription).

Main Contributions:
- Novel application of NLP timeseries techniques like BERT to structured EHR data to model patient clinical timelines. 
- Comparison of different model architectures (recurrent networks, BERT, bag-of-words baselines) over two problem formulations.
- Ablation studies quantifying the impact of different input modalities. Combining diagnoses, procedures and prescriptions data improves performance.
- Analysis showing pre-trained BERT models are beneficial when labeled training data is small. BERT leverages unlabeled pre-training.
- New labeled dataset for clopidogrel treatment failures annotated from UK Biobank using rule-based cohort identification from structured diagnosis and prescription codes.

The paper demonstrates structured EHR data can be effectively modeled using timeline approaches from NLP for clinical predictions tasks. Both problem formulation and model architecture impact overall performance.
