# [Legged Robot State Estimation within Non-inertial Environments](https://arxiv.org/abs/2403.16252)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
This paper tackles the problem of state estimation for legged robots operating inside non-inertial environments such as ships, underwater vehicles, and public transit vehicles. These environments exhibit continuous multi-directional motion which breaks the common assumption of a static ground made by existing state estimation approaches. Further, these environments are typically GPS-denied and enclosed, preventing access to environmental landmarks. Therefore, the paper focuses on real-time state estimation to enable legged robot navigation inside a GPS-denied, enclosed, dynamically moving environment without relying on knowledge of the environment's motion.

Proposed Solution:
The paper proposes an invariant extended Kalman filter (InEKF) for estimating the robot's orientation, velocity and position relative to the non-inertial dynamic environment it is operating in. The process model underlying the filter explicitly models the unknown movement of the non-inertial environment without needing to know this movement in inertial space or rely on GPS or environmental landmarks. Further, it is shown that the process model obeys the group-affine property, leading to an exactly log-linear error dynamics independent of state trajectories. The measurement model fuses proprioceptive sensing from the robot's IMU and leg encoders with an IMU attached to the moving environment. Observability analysis confirms observability of all estimated states during environment motion.

Main Contributions:
1) Analytically extends standard leg odometry measurement model to non-inertial environments using kinetic characteristics of robot movement on an accelerating ground.
2) Formulates a group-affine process model to enable fast error convergence and exact logarithmic error dynamics of the proposed InEKF.
3) Renders the relative robot pose and velocity observable by fusing measurements from proprioceptive sensors and an IMU attached to the dynamic environment, without reliance on exteroceptive sensing.  
4) Validates the approach through real robot experiments on a pitch and sway treadmill, demonstrating high accuracy and convergence speed even under significant ground motion and large initial errors.
