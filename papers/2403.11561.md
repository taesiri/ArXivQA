# [Learning Unified Reference Representation for Unsupervised Multi-class   Anomaly Detection](https://arxiv.org/abs/2403.11561)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Existing anomaly detection methods face challenges when adapted to multi-class anomaly detection. Reconstruction-based methods are prone to "learning shortcuts" during training, wherein they learn shortcuts like identity mapping instead of properly learning normal patterns. This causes them to fail at reconstructing anomalies as normal, resulting in failure of anomaly detection.

Solution:
The paper proposes a unified anomaly detection framework called RLR (Reconstruct features from Learnable Reference) that reconstructs features from a learnable reference representation. This forces the model to learn normal patterns instead of shortcuts. 

Key ideas:

1. Remove residual connections in transformer encoder to eliminate possibility of identical mapping. Replace self-attention with two proposed attention mechanisms:

- Local Cross Attention (LCA): Performs cross-attention between input features (as queries) and learnable reference tokens (as keys and values). Also uses a locality-aware mask to enable better learning of local normal patterns.  

- Masked Learnable Key Attention (MLKA): Uses learnable reference tokens as keys. Also uses neighbor-masked self-attention to prevent over-smoothing.

2. Loss function uses MSE and cosine similarity between original and reconstructed features.

3. At inference, score is computed as difference between original and reconstructed features.

Main Contributions:

- Proposes a framework to reconstruct features from learnable references to avoid learning shortcuts and enforce learning of normal patterns

- Introduces Local Cross Attention and Masked Learnable Key Attention to enhance reconstruction accuracy

- Achieves state-of-the-art performance on MVTec AD and VisA datasets, outperforming prior unified frameworks.

The key insight is to base reconstruction on explicit learnable representations of normal features instead of direct input mapping. This prevents shortcuts and enables robust anomaly detection across multiple categories.
