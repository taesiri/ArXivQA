# [Intrinsic Harmonization for Illumination-Aware Compositing](https://arxiv.org/abs/2312.03698)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Image compositing requires inserting an object onto a new background in a realistic way. This is challenging as the object needs to match the color content and illumination of the new background environment. Prior image harmonization methods mainly focus on color adjustments and neglect relighting the object. Explicitly modeling illumination is difficult and requires specialized datasets. As a result, most relighting methods are limited to specific domains like portraits. There is a need for a general harmonization method that can realistically adjust both the color and illumination of inserted objects.

Proposed Solution: 
The authors propose an illumination-aware image harmonization method formulated in the intrinsic image domain, which decomposes an image into reflectance (albedo) and shading. This allows separate color and illumination harmonization steps. First, the albedo of foreground and background are harmonized using parameterized image edits to match colors. Next, a simple parametric illumination model is estimated from the background shading and normals. This is used to render initial Lambertian shading for the foreground. A neural network then refines this shading to generate realistic foreground illumination matching the background lighting. The network is trained via self-supervision on segmentation masks using the rendered shading as input and original shading as target.

Main Contributions:
- Formulating image harmonization in the intrinsic domain to allow separate color and illumination adjustments 
- Estimating a parametric illumination model from background shading and normals to guide foreground relighting
- Self-supervised training of a neural network to refine Lambertian shading into realistic illumination, avoiding specialized datasets
- Qualitative and quantitative experiments showing the method generates more realistic composites than prior color and illumination harmonization techniques

The key advantage is the ability to realistically relight inserted objects to match background illumination in challenging real-world images, which is difficult for prior harmonization methods. This leads to more realistic image composites.
