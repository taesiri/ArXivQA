# [Balancing Act: Distribution-Guided Debiasing in Diffusion Models](https://arxiv.org/abs/2402.18206)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper "Balancing Act: Distribution-Guided Debiasing in Diffusion Models":

Problem:
- Diffusion models (DMs) can generate high-quality images but reflect the biases (e.g. gender, race) present in the training data. This leads to unfair generations, for example generating more females than males.
- Existing debiasing methods require retraining the DM with extra balanced data or modifying the model. However, retraining large DMs is computationally expensive. 

Proposed Solution:
- The paper proposes a method to debias existing pretrained DMs without any retraining, by simply providing a reference distribution of the desired attributes during generation. 
- Key idea is "distribution guidance" which guides a batch of generated samples to match the reference attribute distribution, unlike existing approaches that guide one sample at a time.
- An Attribute Distribution Predictor (ADP) network is trained to predict attribute distribution from intermediate DM features called h-space. 
- During generation, ADP predictions are matched to reference distribution by updating h-space features, allowing flexible modification of attributes.

Main Contributions:
- Novel setting to debias DM by providing reference attribute distribution, without retraining.
- Proposing distribution guidance to condition a batch of samples, instead of restrictive per-sample conditioning.  
- Guidance performed in efficient h-space instead of image space, enabling fast training and inference of ADP.
- Extensive experiments showing state-of-the-art debiasing for single/multiple attributes on unconditional and text-conditional DMs.
- Downstream application of training debiased classifier by balancing datasets using generated minority data.

In summary, the paper presents an inference-time method to debias existing pretrained diffusion models by guiding a batch of samples to match a reference attribute distribution. This is achieved via efficient guidance in the intermediate h-space features and outperforms per-sample conditioning strategies.
