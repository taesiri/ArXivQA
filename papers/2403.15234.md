# [Shadow Generation for Composite Image Using Diffusion model](https://arxiv.org/abs/2403.15234)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Generating realistic shadows for inserted foreground objects in composite images remains challenging. Previous image-to-image translation methods struggle to produce accurate and consistent shadows due to limited training data and task complexity.  

Proposed Solution:
This paper proposes a novel diffusion model called Shadow Generation Diffusion (SGDiffusion) to generate plausible shadows for foreground objects in composite images. The key contributions are:

1. A new large-scale real-world dataset called DESOBAv2 with 28,573 image pairs for training shadow generation models. It is created by leveraging object-shadow detection and inpainting techniques. 

2. An adapted conditional diffusion model based on ControlNet, which takes the composite image and foreground mask as input and predicts the shadow image. Innovations include weighted noise loss to focus on shadow regions and an intensity encoder to modulate the shadow darkness.  

3. A post-processing network to refine the generated shadows and reduce color shift and background changes. 

Experiments on DESOBAv2 and real composite images demonstrate superior performance over previous methods. Both qualitative and quantitative results validate the importance of the large-scale dataset and effectiveness of the proposed model. Shadow shapes, locations and intensity consistency are significantly improved.

In summary, this paper makes notable contributions in constructing a novel shadow generation dataset, designing an end-to-end deep diffusion model, and advancing the state-of-the-art in realistic shadow generation for image composition.
