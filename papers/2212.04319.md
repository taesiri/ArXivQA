# [On the Robustness of Normalizing Flows for Inverse Problems in Imaging](https://arxiv.org/abs/2212.04319)

## What is the central research question or hypothesis that this paper addresses?

 Based on my reading of the paper, the central research question it addresses is: 

Why do conditional normalizing flows for solving inverse problems in imaging occasionally generate unintended erroneous image samples, and how can this issue be addressed?

Specifically, the key points are:

- The paper investigates the origins of artifacts/errors sometimes observed in image samples generated by conditional normalizing flows used for tasks like super-resolution and low-light image enhancement. 

- It reveals that these errors are caused by "exploding inverses" in the conditional affine coupling layers commonly used in normalizing flows, which can happen when the conditional input is out-of-distribution.

- The paper validates that conditional inputs yielding exploding inverses are out-of-distribution from the perspective of the conditioning network, even though they may be in-distribution data for humans. 

- It proposes remarks/conditions on how to avoid exploding inverses in conditional normalizing flows for inverse imaging problems.

- As a remedy, it suggests replacing affine coupling layers with modified rational quadratic spline coupling layers that meet the proposed criteria. 

- Experiments demonstrate the method can effectively suppress artifacts in tasks like super-resolution and low-light image enhancement.

In summary, the key hypothesis is that exploding inverses due to out-of-distribution inputs in conditional affine coupling layers cause artifacts, and this can be addressed by using coupling layers that avoid exploding inverses for out-of-distribution data.


## What is the main contribution of this paper?

 Based on my reading, the main contributions of this paper are:

1. Empirically and theoretically revealing that artifacts/errors arising in conditional normalizing flows for inverse problems in imaging are caused by a mechanism similar to "exploding inverses" in unconditional normalizing flows. 

2. Showing that the conditional inputs that lead to exploding inverses and artifacts are actually out-of-distribution from the perspective of the conditioning network, even though they may be in-distribution data. This is validated using Mahalanobis distance based out-of-distribution scores.

3. Proposing remarks/guidelines on how to avoid exploding inverses in conditional normalizing flows for inverse problems in imaging. 

4. Demonstrating a simple remedy to avoid exploding inverses by substituting affine coupling layers with modified rational quadratic spline layers in normalizing flows. This modification is shown to effectively suppress artifacts in applications like super-resolution space generation and low-light image enhancement.

In summary, the key contribution is revealing, analyzing and proposing ways to address the issue of exploding inverses and occasional artifacts in conditional normalizing flows for solving inverse problems in imaging. The paper provides useful insights into improving the robustness of normalizing flows.
