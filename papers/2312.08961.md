# [Contact-Implicit MPC: Controlling Diverse Quadruped Motions Without   Pre-Planned Contact Modes or Trajectories](https://arxiv.org/abs/2312.08961)

## Write a very high-quality paragraph summarizing the paper that effectively covers the paper.

 Here is a high-quality paragraph summarizing the key points of the paper:

This paper presents a model predictive control (MPC) framework that can simultaneously generate and execute diverse multi-contact motions for quadruped robots, without needing pre-defined contact sequences or trajectories. It uses a differential dynamic programming approach integrated with a hard contact model and analytical gradient computation of contact forces. To facilitate exploration of motions involving breaking contacts, the authors propose a novel smoothed gradient based on relaxed complementarity constraints. Additional cost terms are incorporated to ensure reliable foot clearance and prevent slippage. To address sensitivity to inaccurate state estimates in real-world use, a multiple shooting variant of the algorithm is leveraged to enhance robustness. The method's efficacy is demonstrated through dynamic 3D quadruped simulations and hardware experiments involving a trot gait and front-leg rearing on a 45kg robot. Key advantages are real-time performance, adaptive responses to disturbances, and the capacity to produce agile maneuvers without task-specific tuning. Limitations center around state estimation accuracy, and future work may integrate learning-based approaches to improve robustness. Overall, this contact-implicit MPC approach shows promise for enhancing autonomy in legged robots.


## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Generating agile and dynamic behaviors for legged robots requires simultaneously determining appropriate contact sequences and forces/torques. However, most model predictive control (MPC) methods for legged robots rely on pre-defined contact sequences, limiting the range of achievable motions. Some contact-implicit optimization methods can discover motions and contacts concurrently, but face challenges in computational complexity, ensuring feasible contacts, inadequate foot lifting, and robust real-time deployment.

Solution:
This paper proposes a contact-implicit model predictive control framework that can simultaneously generate and execute diverse multi-contact motions for quadruped robots, without needing pre-planned contact sequences or trajectories. 

Key ideas:
- Employs differential dynamic programming (DDP) for real-time optimization by analytically computing gradients of contact forces based on a hard contact model and relaxed complementarity constraints. This facilitates optimization along directions that break contacts.

- Additional cost terms guide foot lifting heights and slippage to ensure feasible motions. Costs on air time and symmetric leg motions produce natural gaits like trotting.  

- Uses a multiple shooting variant of DDP (FDDP) for optimization initialization through previous solution trajectories. This enhances robustness to mismatches between predicted and actual initial states during real-time deployment.

Main Contributions:
- Contact-implicit DDP framework generates a variety of multi-contact quadruped motions starting from simple body pose/position goals, without needing pre-defined contacts or trajectories.

- Novel analytical gradients based on relaxed complementarity constraints promote exploration of motions involving making/breaking contacts during optimization.

- Incorporation of costs guiding foot clearance, gait patterns, and use of multiple shooting optimization enhances feasibility and robustness.

- Demonstrates the approach through high-fidelity 3D simulations and hardware experiments involving trotting, rearing maneuvers, etc. on a 45 kg quadruped robot.

In summary, the paper proposes an optimized contact-implicit planning approach to generate more dynamic and agile legged robot behaviors suitable for real-time control, while overcoming limitations of pre-specification, feasibility, and robustness in prior methods.
