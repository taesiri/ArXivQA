# [Natural Language Commanding via Program Synthesis](https://arxiv.org/abs/2306.03460)

## What is the central research question or hypothesis that this paper addresses?

Based on my reading of the paper, the central research question or hypothesis appears to be: How can we develop a natural language-friendly AI system to execute user intent across application features in productivity software like Microsoft Office?The key ideas and components to address this question seem to be:- Developing a domain-specific language (ODSL) that provides an abstraction layer between natural language and application APIs, allowing for separation of user intent understanding from execution.- Using large language models for program synthesis to translate natural language queries into executable ODSL programs.- An analysis-retrieval method to construct effective prompts for the LLMs by retrieving relevant examples and artifacts conditioned on the input query.- Automatic code correction techniques to improve robustness of the synthesized ODSL programs.- An evaluation procedure based on program equivalence analysis to evaluate different system variants.The overall hypothesis appears to be that by combining LLMs for understanding user intent with a domain-specific language for intent fulfillment, they can develop a natural language commanding system with improved robustness compared to using LLMs alone. The ablation study seems designed to validate the contributions of the different system components.


## What is the main contribution of this paper?

The main contributions of this paper are:1. The design of the Office Domain Specific Language (ODSL), which is a high-level, LLM-friendly language specialized for performing actions and interacting with entities in Office applications like PowerPoint.2. The architecture of Semantic Interpreter, which leverages an analysis-retrieval prompt construction method with large language models to translate natural language user queries into executable ODSL programs.3. A procedure for evaluating natural language commanding systems that leverage program synthesis by reformulating it as program equivalence analysis. 4. An exploration focused on PowerPoint that demonstrates the potential of using program synthesis and ODSL to build natural language commanding experiences for productivity software.In summary, the key ideas are using program synthesis with a custom domain-specific language ODSL to enable natural language commanding of Office applications, and an analysis-retrieval prompt engineering method to make this approach robust and accurate. The evaluation procedure analyzes program equivalence rather than exact match to a single ground truth program. Overall, this work illustrates a promising approach to build AI systems that can understand and execute user intent across application features using natural language.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

Here is a one sentence summary of the key points from the paper:The paper presents Semantic Interpreter, an AI system that leverages large language models and a domain-specific language called ODSL to translate natural language commands into executable programs for manipulating content in Microsoft Office applications.


## How does this paper compare to other research in the same field?

Here are some thoughts on how this paper compares to other research in natural language interface for productivity applications:- Most prior work has focused on developing natural language interfaces for specific features of productivity apps, rather than a comprehensive system like Semantic Interpreter that aims to cover the full commanding surface. For example, there has been work on NL interfaces for slide editing in PowerPoint, table operations in Excel, email automation in Outlook, etc. This paper proposes a more holistic approach.- The idea of using program synthesis to map natural language to executable actions is relatively new in this domain. As discussed in the related work section, most prior systems directly map NL to API calls or use retrieval/ranking to find the best matching API sequence. Explicitly generating a symbolic program representation is an important contribution of this work.- The design of the Office Domain Specific Language (ODSL) and the focus on making it ML-friendly sets this work apart. Many existing NL interfaces use the native APIs of an application directly, which can be challenging for ML models. ODSL provides an abstraction tailored for the domain.- The analysis-retrieval method for prompt engineering is novel. Most few-shot learning works for code generation just do a generic semantic search over examples. The entity-based filtering and sub-sampling of examples based on document context makes the prompting more precise.- The procedure proposed for evaluating natural language commanding systems using program equivalence checking is more rigorous than typical subjective human evaluations. It provides a way to quantitatively analyze different system variants.- The overall system design combining retrieval, LLMs, DSL, and code analysis/correction follows a neurosymbolic approach of blending strengths of neural approaches with symbolic AI. This allows the system to have interpretability, correctness and precision along with the benefits of large scale pretraining.In summary, this paper pushes forward the state-of-the-art in building comprehensive natural language interfaces for productivity applications by integrating several advances related to program synthesis, prompt engineering, domain-specific languages and neurosymbolic methods. The evaluation procedure also sets up a framework for more standardized comparisons between different techniques.


## What future research directions do the authors suggest?

Based on my reading of the paper, some key future research directions the authors suggest are:- Expanding the scope of ODSL to cover more functionality in Office apps beyond what the current exploration for PowerPoint covers. The paper mentions ODSL can be similarly specified for other Office apps like Word, Excel, etc. - Exploring the use of ODSL for applications beyond Office productivity software as well, such as web apps, creative tools, etc. The framework seems generalizable.- Improving the robustness of the program synthesis, for example by exploring techniques like type-guided synthesis.- Evaluating the approach on real users to study usability. The paper currently evaluates on an offline benchmark. - Studying how to constructively provide feedback to the user when the system is unable to fulfill an intent or makes mistakes.- Exploring personalization of the system's behavior over time based on interaction history with a user.- Improving the concision of ODSL while maintaining expressivity.- Studying mechanisms for interactive clarification of ambiguous user intents.- Expanding the set of model architectures used for program synthesis beyond LLMs.In summary, the key directions are: expanding ODSL scope, robustness improvements, real user evaluations, providing user feedback, personalization, concision vs expressivity tradeoffs, interactive clarification, and exploring new model architectures.


## Summarize the paper in one paragraph.

The paper presents Semantic Interpreter, an AI system that enables natural language commanding of productivity software like Microsoft Office. It uses large language models (LLMs) for program synthesis to translate user intent expressed in natural language into executable programs. To do this effectively, the authors introduce the Office Domain Specific Language (ODSL), a concise language specialized for performing actions in Office applications. ODSL provides an abstraction layer on top of Office APIs to constrain the space of programs, making it easier for LLMs to learn. The authors employ an analysis-retrieval method to construct prompts for the LLMs, selecting relevant program examples and artifacts conditioned on the input user query. This allows few-shot prompting of LLMs for program synthesis under constrained token budgets. The synthesized ODSL programs are validated, auto-corrected if needed, and transpiled into Office APIs for execution. Experiments show the contributions of the various components of Semantic Interpreter. While focused on PowerPoint, the framework is generalizable to other Office apps and productivity software.
