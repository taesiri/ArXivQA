# [FlatNAS: optimizing Flatness in Neural Architecture Search for   Out-of-Distribution Robustness](https://arxiv.org/abs/2402.19102)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Neural networks suffer from poor out-of-distribution (OOD) generalization, meaning their performance degrades significantly when tested on data different from the training distribution. This is a major issue for real-world applications.
- Neural Architecture Search (NAS) methods have focused on finding architectures that optimize accuracy on in-distribution data, while neglecting their robustness. Smaller architectures found by NAS are particularly prone to poor OOD generalization.
- Existing NAS methods for robustness focus mainly on adversarial robustness rather than OOD generalization. There is a need for a NAS solution tailored specifically for OOD generalization.

Proposed Solution:
- The paper proposes FlatNAS, a NAS method that searches for neural network architectures with good performance on in-distribution data as well as inherent robustness to OOD data shifts.
- A key innovation is the use of sharpness-aware minimization (SAM) during NAS to optimize flatness of loss landscape, which is related to OOD generalization.
- FlatNAS introduces a new robustness metric R(x,σ) that measures architecture accuracy under weight perturbations, indicating flatness. This is combined with standard accuracy in a multi-objective fitness function to guide NAS.
- Parameter constraints are handled through an additional penalty term in the objective.
- The search space uses a Once-For-All supernet based on MobileNetV3. Genetic algorithm NSGA-II is used for exploration.

Main Contributions:
- First NAS method to systematically search for flat regions of loss landscape to enhance OOD robustness, while constraining model parameters.
- Introduction of a new robustness metric R(x,σ) tailored to evaluate architecture robustness during NAS based on weight perturbations.
- Experiments show FlatNAS finds architectures with significantly improved corruption robustness and OOD generalization compared to standard NAS, with minimal reduction in in-distribution accuracy.
- Analysis reveals FlatNAS architectures tend to prefer larger kernel sizes, which could contribute to increased robustness.
