# [On Predictive planning and counterfactual learning in active inference](https://arxiv.org/abs/2403.12417)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement:
The paper examines two decision-making schemes in the active inference framework - one based on planning for the future (DPEFE) and one based on learning from experience (counterfactual learning or CL). The goal is to understand the strengths and weaknesses of each approach and explore ways to balance them. 

The DPEFE scheme uses predictive planning to evaluate future outcomes and make optimal decisions. However, the computational complexity scales exponentially with the planning depth/horizon. The CL scheme learns a state-action mapping based on experience and risk evaluation. It is computationally cheaper but requires more environmental interactions to learn effectively.  

There is a trade-off between data efficiency and computational complexity between the two methods. Biological agents likely employ a mix of planning and experiential learning.

Proposed Solution:
The paper proposes a mixed model to balance planning and learning. A bias parameter β(s,t) keeps track of the agent's relative confidence in each scheme for a given state. It gets updated based on the relative entropy/uncertainty of the action distributions from each scheme. 

A new distribution P(u|s)_MM mixes the DPEFE and CL distributions weighted by β. This allows the agent to leverage its experience as well as look ahead where beneficial. The update rules for β and P_MM are derived from variational free energy minimization.

Contributions:

- Comparison of two decision-making schemes in active inference - planning-based DPEFE and experience-based CL
- Identifying a trade-off between data efficiency and computational complexity
- A mixed model that balances planning and learning by tracking confidence in each scheme
- Testing in environments requiring reactive (cartpole) and strategic (maze navigation) control
- Demonstrating the mixed model's adaptability in a mutating maze environment 
- Providing insights into decision-making through the evolution of model parameters

The mixed model balances computational resources and data availability. It is adaptable as complexity increases, much like biological organisms. Analyzing the model parameters also enables better explainability of the basis of intelligent behavior.
