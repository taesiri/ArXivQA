# [Theory of Hallucinations based on Equivariance](https://arxiv.org/abs/2312.14504)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Language models can misinterpret token ID sequences or generate incorrect outputs (hallucinations) due to insufficient equivariance (the ability to interpret sequences with the same meaning consistently). 
- Validating the link between insufficient equivariance and hallucinations requires modeling complex substitution ciphers at scale, which is computationally demanding.

Proposed Solution:
- Use a T5 model to learn to decipher a character-level substitution cipher ("dancing men") without relying on frequency analysis.
- Input is encrypted text, output is the substitution rule itself. Model learns to infer encryption rules.
- Evaluate model's equivariance by testing it on custom encrypted passages. Incorrect decryptions highlight areas of insufficient equivariance.

Main Contributions:
- Proposes hypothesis linking insufficient equivariance in language models to hallucinations.
- Develops T5-based system to decipher character substitution ciphers without frequency analysis.
- System decrypts 24/27 characters accurately on complex test passages, showing ability to acquire equivariance.
- Incorrect decryptions showcase how flawed equivariance enables possible misinterpretations/hallucinations.
- Approach is scalable to evaluating equivariance in large language models to quantify link with hallucinations.

In summary, the paper introduces an original hypothesis about equivariance deficiencies causing hallucinations in language models, and develops a novel T5 modeling approach to systematically analyze equivariance at scale to validate this hypothesis. Key contributions include the core idea itself and a scalable methodology for rigorous testing.
