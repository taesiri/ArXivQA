# [Context-Enhanced Relational Operators with Vector Embeddings](https://arxiv.org/abs/2312.01476)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Traditional database optimizations and cost models do not account for machine learning models which may be on the critical path of query execution. Models introduce additional costs related to data access, computation time, etc.
- Embeddings change the data domain from atomic data types to high-dimensional vectors, impacting data movement and cache locality characteristics.

Proposed Solution:
- Introduce a cost model that accounts for data access, model, and computation costs of operations over embeddings.
- Formulate selection and join operators to explicitly account for embedding costs. An optimization is shown for join by prefetching embeddings.
- Introduce a tensor formulation of joins over embeddings that enables matrix-based algorithms and optimizations from linear algebra. This allows reasoning about parallelization, cache locality, etc.  

Contributions:
- Context-aware cost model for selection and join operators over embeddings.
- Optimization of join operator by prefetching embeddings. Reduces model access cost from quadratic to linear.  
- Novel tensor formulation of join that enables matrix-based algorithms and optimizations. Allows tuning algorithms based on cost model and execution environment.

In summary, the paper proposes a context-aware cost model and optimizations for querying over machine learning embeddings in a relational database. A key insight is using a tensor formulation to enable matrix-based algorithms and optimizations. This allows traditional relational optimizations to interact with properties of embeddings for more efficient query processing.
