# [Weakly-supervised Single-view Image Relighting](https://arxiv.org/abs/2303.13852)

## What is the central research question or hypothesis that this paper addresses?

 Based on my reading, the central research question/hypothesis of this paper is: 

How to relight a single image of real-world objects under novel lighting conditions, which enables inserting photographed objects into new scenes with proper illumination effects for augmented reality applications?

The key challenges are:

1) Inverse rendering from a single image is highly ill-posed, as it requires estimating geometry, materials, and lighting from just one observation. 

2) Re-rendering objects under novel lighting requires handling non-Lambertian materials and environment lighting.

To address these challenges, the paper proposes:

1) A weakly-supervised inverse rendering pipeline trained with a novel low-rank loss on real image datasets. This helps resolve the ill-posed inverse rendering problem.

2) A differentiable non-Lambertian rendering layer that can render low-frequency specular materials under environment lighting represented with spherical harmonics. This enables re-rendering of materials from diffuse to glossy.

The overall approach enables realistic relighting and insertion of photographed objects into new scenes from just a single input image, which could benefit mobile augmented reality applications. The effectiveness is demonstrated through experiments and a mobile app implementation.


## What is the main contribution of this paper?

 The main contributions of this paper are:

- A weakly-supervised inverse rendering pipeline trained with a low-rank loss. The correctness and convergence of the loss are mathematically proven.

- A large-scale dataset of foreground-aligned videos collecting 750K images of 100+ real objects under different lighting conditions. This facilitates training and can benefit other vision tasks. 

- A differentiable specular rendering layer to render low-frequency non-Lambertian materials under spherical harmonic lighting. This enables relighting objects with a range of materials.

- An end-to-end pipeline for single image relighting of real objects, allowing insertion into new scenes. This is implemented in a mobile app.

In summary, the key contribution is the weakly-supervised learning framework and differentiable renderer that together enable real object relighting from a single image. The large dataset, proofs, and mobile app are secondary contributions that support the main technique.


## What is the TL;DR (Too Long, Didn't Read) version of the paper? If you had to summarize it in one sentence, what would that be?

 Here is a one sentence summary of the paper:

The paper proposes a weakly-supervised approach for relighting real objects in augmented reality using a low-rank constraint on reflectance matrices and a differentiable renderer, enabled by a large dataset of videos of objects under varying illumination.


## How does this paper compare to other research in the same field?

 Here are some key comparisons between this paper and other related work in single image relighting:

- This paper proposes a weakly-supervised approach for single image inverse rendering and relighting. Most prior work relies on synthetic datasets with ground truth supervision or multi-view supervision. This paper uses a novel low-rank loss to train on real images without ground truth.

- For inverse rendering, this paper jointly predicts lighting, normals, and reflectance in an end-to-end differentiable pipeline that strictly follows the image formation model. Many prior works tackle each task separately or use separate networks without enforcing physical constraints. 

- For relighting, this paper presents a differentiable non-Lambertian renderer that can produce specular highlights from normal maps and spherical harmonic lighting. Prior neural rendering techniques require meshes and cannot handle normal maps. Prior image relighting is mostly limited to Lambertian scenes.

- The paper contributes a large-scale dataset of 750K real images of foreground objects with changing illuminations. Most datasets for this task are synthetic. The real data is key to avoiding the domain gap.

- Experiments show superior performance over state-of-the-art methods in intrinsic image decomposition, normal estimation, and relighting. An end-to-end mobile app is implemented.

In summary, the main advances are in designing a self-supervised pipeline tailored for real single images, enabled by the novel low-rank loss and dataset. The differentiable non-Lambertian renderer also expands the application scope. The weakly-supervised approach avoids the need for expensive ground truth supervision.


## What future research directions do the authors suggest?

 Based on my reading of the paper, some of the main future research directions suggested by the authors include:

- Adding cast shadow rendering to improve realism - The authors note that cast shadows are not currently considered in their relighting approach. Adding cast shadow rendering could help narrow the gap between the relighting results and reality.

- Modeling transparent/translucent materials - The parametric models like Blinn-Phong and Phong have difficulty with semitransparent and transparent materials. Developing techniques to model and render these materials could expand the applicability of the method.

- Modeling high-frequency lighting - The use of spherical harmonics limits the ability to represent high-frequency lighting effects. Exploring ways to incorporate high-frequency lighting could improve realism.

- Exploring adaptive spherical harmonics lighting models - The authors suggest region-adaptive spherical harmonics to fit different levels of harmonics to different environment regions. This could provide flexibility in lighting representation.

- Adding more types of data to the Relit dataset - The authors propose capturing additional lighting conditions like multi-view video under static lighting. Expanding the diversity of data could benefit many tasks.

- Handling cast shadows and visibility - Accounting for occlusions and shadows in a physically accurate way would improve realism.

- Exploring generative/neural rendering techniques - As alternatives to parametric models, using neural rendering and generative models is a potential direction.

In summary, the main suggestions are around improving realism through advances in material modeling, lighting, shadows/occlusion, as well as expanding the Relit dataset diversity and exploring generative techniques.


## Summarize the paper in one paragraph.

 Here is a one paragraph summary of the paper:

This paper presents a learning-based approach for relighting a single image of Lambertian and low-frequency specular objects. The method enables inserting photographed objects into new scenes and relighting them under the new environment lighting, which is useful for AR applications. To relight the object, the method solves both inverse rendering (estimating properties like shape, reflectance, illumination from an image) and re-rendering (generating a new image using the estimated properties). There are two main challenges: the lack of labeled training data for inverse rendering, and the lack of differentiable specular renderers for environment lighting. To resolve the ill-posed inverse rendering, a weakly-supervised method with a low-rank constraint is proposed. It imposes that the reflectance maps of an object under different illuminations are linearly correlated. To facilitate the weakly-supervised training, a large-scale dataset of real images is collected. For re-rendering, a differentiable specular rendering layer is proposed to handle non-Lambertian materials under spherical harmonic lighting. The overall pipeline is efficient and end-to-end, enabling a mobile app implementation.


## Summarize the paper in two paragraphs.

 Here is a two paragraph summary of the paper:

This paper presents a learning-based approach for relighting a single image of Lambertian and low-frequency specular objects. The method enables inserting photographed objects into new scenes and relighting them under the new environment lighting, which is useful for AR applications. The approach tackles two main challenges: inverse rendering from a single image which is ill-posed, and re-rendering under novel lighting which requires handling non-Lambertian materials. 

To address inverse rendering, the paper proposes a weakly-supervised method using a low-rank constraint on reflectance maps and a re-rendering loss. A large-scale dataset called Relit of aligned object videos under varying illumination is collected to facilitate this learning. For re-rendering, the paper presents a differentiable specular rendering layer based on Blinn-Phong reflection and spherical harmonics lighting to handle low-frequency non-Lambertian materials. This enables relighting objects with a range of material properties. Experiments validate state-of-the-art performance on inverse rendering tasks and relighting. The method is implemented in a mobile app that allows inserting and relighting photographed objects.


## Summarize the main method used in the paper in one paragraph.

 This paper presents a weakly-supervised approach for single-image relighting of real objects. The key contributions are:

- A weakly-supervised inverse rendering pipeline trained with a novel low-rank loss on reflectance. This imposes that the reflectance maps of an object under different illuminations should be linearly correlated. The loss is proven to converge to the optimal solution. 

- A large-scale dataset "Relit" of 750K foreground-aligned images capturing 100+ real objects under varying illuminations. This facilitates self-supervised training.

- A differentiable non-Lambertian renderer layer using spherical harmonics lighting and Blinn-Phong reflection model. This enables rendering objects with glossy materials and environment lighting for relighting.

- An end-to-end pipeline from single image inverse rendering to relighting real objects under novel lighting and materials. An Android app is implemented for amateur users.

To summarize, this paper tackles the challenging ill-posed problem of single image relighting of real objects, through weakly supervised deep learning and differentiable rendering layers. The large-scale real image dataset and convergence proof of the loss are key enablers. Both quantitative and qualitative results demonstrate state-of-the-art performance in realistic object relighting and insertion effects.


## What problem or question is the paper addressing?

 The key points from the paper are:

- The paper addresses the problem of relighting real objects from a single image, which enables inserting photographed objects into new scenes with proper lighting effects. This is useful for augmented reality applications. 

- It tackles two key challenges: solving the ill-posed inverse rendering problem to recover properties like shape, material, lighting from a single image, and developing a differentiable rendering model to re-render the object under new lighting.

- For inverse rendering, it proposes a weakly-supervised method trained on a large dataset of real images captured under varying illumination. A low-rank loss is used to constrain the reflectance to be consistent across illuminations.

- For re-rendering, it develops a differentiable specular rendering layer that can render non-Lambertian materials under spherical harmonic illumination. 

- The overall pipeline enables end-to-end relighting of real objects from a single photo, and supports editing material properties like diffuse vs glossy.

- The method is evaluated on tasks like intrinsic image decomposition and normal estimation, showing state-of-the-art performance. Realistic relighting results are demonstrated.

- An Android app is implemented that allows capturing and inserting relit objects into scenes. This enables amateur AR experiences.

In summary, the key contribution is a learning-based single-image relighting pipeline for real objects, enabled by novel losses and rendering layers. It advances the state-of-the-art in inverse rendering and enables mobile AR relighting applications.
