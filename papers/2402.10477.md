# [Understanding Likelihood of Normalizing Flow and Image Complexity   through the Lens of Out-of-Distribution Detection](https://arxiv.org/abs/2402.10477)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Deep generative models (DGMs) like normalizing flows and autoregressive models are expected to assign higher likelihood (probability density) to in-distribution (In-Dist) data than out-of-distribution (OOD) data. However, perplexingly it has been found that they often assign higher likelihoods to unknown OOD inputs.  
- This phenomenon is referred to as the "failure of likelihood" and undermines the credibility of likelihood-based tests for OOD detection using DGMs.

Proposed Solution:  
- The paper hypothesizes that less complex images concentrate in high-density regions of the DGM's latent space. This results in higher likelihood assignments by the model, irrespective of whether the images are In-Dist or OOD.
- They refer to this as the "Density Concentration Attraction for Simpleness (DCAS)" effect. The DCAS causes OOD images with less complexity to be mapped closer to the high-density region, leading to higher likelihoods.
- They propose that explicitly modeling image complexity as an independent variable, in addition to the latent space likelihood, can mitigate this issue.

Main Contributions:
- Provides a hypothesis explaining why OOD images with less complexity get higher likelihoods in DGMs. Unifies explanations for two questions - why less complex images get higher likelihoods and why OOD data is sometimes wrongly identified as belonging to the typical set.  
- Validates the DCAS hypothesis through experiments on 5 normalizing flow architectures. Shows DCAS occurs irrespective of architecture. Concludes that reliance solely on likelihoods from normalizing flows is untenable.
- Demonstrates that modeling complexity as an independent variable alleviates the problem. A simple Gaussian mixture model combining complexity and likelihood perfectly detects all OOD data in the experiments.
- Provides evidence that the DCAS hypothesis likely applies to autoregressive models as well. Complexity-aware PixelCNN++ significantly outperforms baseline on OOD detection.

In summary, the paper clearly explains the mechanism behind the "failure of likelihood" phenomenon in DGMs and shows that explicitly accounting for image complexity information can overcome this fundamental limitation of likelihood-based OOD detection approaches.
