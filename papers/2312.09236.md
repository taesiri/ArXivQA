# [A framework for conditional diffusion modelling with applications in   motif scaffolding for protein design](https://arxiv.org/abs/2312.09236)

## Write a very high-quality paragraph summarizing the paper that effectively covers the paper.

 Here is a summary paragraph of the key points from the paper:

This paper presents a unified framework for conditioning diffusion models based on Doob's h-transform. The framework provides theoretical backing for existing conditional generation methods and leads to a proposed novel approach called "amortised training". In amortised training, the conditioning information is provided to the model during training so that it learns to satisfy the conditioning constraints. This differs from other methods that enforce constraints during sampling. The paper illustrates the framework on image outpainting and protein motif scaffolding tasks. An amortised training implementation is tested on these applications and shown to outperform existing conditioning protocols like reconstruction guidance and replacement sampling. The method is analyzed in detail on protein design problems using motif scaffolding benchmarks. Results indicate the approach enables sampling of high quality scaffolds with greater success rates compared to alternatives. Overall, the paper delivers an important theoretical grounding, taxonomy, and new algorithm for conditional generation with diffusion models applicable to domains like image and protein generation.


## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Many applications like protein design require precisely scaffolding a structural motif into a larger structure. Recently, generative diffusion models have shown promise for this motif scaffolding task by treating it as a conditional generation problem. However, most conditional generation protocols are proposed in an ad-hoc, heuristic fashion, obscuring connections between approaches.

Proposed Solution: 
This paper provides a unified perspective on conditional training and sampling schemes for diffusion models using the mathematically well-founded concept of Doob's h-transform from stochastic analysis. 

Key Points:

- The paper first shows how Doob's h-transform enables diffusion models to satisfy hard equality constraints during sampling and generalizes this framework to handle soft constraints arising from noisy observations.

- This new perspective allows creating a taxonomy that relates and classifies existing conditional diffusion methods like guidance, inpainting, and classifier-free training. It also reveals a missing method.

- Based on the insight that existing approaches do not model the measurement operator, the authors propose a new "amortized training" scheme that trains the model conditioned on this operator.

- Experimentally, amortized training outperforms existing approaches on image outpainting and protein motif scaffolding tasks. Detailed studies reveal strengths and weaknesses of the method.

Main Contributions:

- Unified framework for conditional diffusions based on Doob's h-transform  

- Taxonomy and connections between existing conditional methods

- New amortized training algorithm that conditions on measurement operator

- Demonstration of effectiveness on image and protein tasks

- Detailed algorithmic framework for implementing conditional diffusions

In summary, the paper provides theoretical grounding and practical algorithms to improve conditional sampling schemes in diffusion models with applications in multiple domains. The proposed amortized training approach emerges as a promising technique for tasks like motif scaffolding.
