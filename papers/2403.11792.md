# [SETA: Semantic-Aware Token Augmentation for Domain Generalization](https://arxiv.org/abs/2403.11792)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Domain generalization (DG) aims to train models that can generalize to unseen target domains. Existing DG methods mostly focus on CNNs and augment data by perturbing style features while keeping semantics unchanged.
- However, they ignore that features also contain spurious edges that are domain-specific. When applied to vision transformers (ViTs) and MLPs that learn spatial dependencies, lacking spatial-level augmentation causes them to overfit local edge tokens encoding spurious edges, limiting generalization ability. 

Method:
- Proposes Semantic-aware Token Augmentation (SETA) that explicitly enhances shape bias and generalization of ViTs/MLPs by introducing local edge perturbations at token-level.

- Has 3 modules: 1) Energy-based Edge Token Selection (ETS) - uses low-pass filters to extract edge maps and select tokens containing edge information. 2) Shape Token Shuffling (STS) - shuffles token locations in a sample to generate texture noise while disrupting holistic shape. 3) Token Mixing - mixes edge tokens from one sample with shuffled tokens from another sample.

- Also extends with style augmentation methods to handle both shape and style shifts.

Contributions:
- Proposes first token-level augmentation method specifically for enhancing shape bias and generalization of ViTs/MLPs.

- Shows theoretically and empirically that explicit spatial augmentation is needed to suppress overfitting of spurious edge tokens unlike style augmentation methods.

- Achieves state-of-the-art performance across 5 datasets on ViT and MLP models. Two stylized variants further improve performance.

- Negligible overhead. Visualizations confirm enhanced focus on global shapes and reduced attention to irrelevant regions.
