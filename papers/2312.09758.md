# [Diagnosing and Rectifying Fake OOD Invariance: A Restructured Causal   Approach](https://arxiv.org/abs/2312.09758)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Invariant representation learning (IRL) methods aim to learn representations that generalize to out-of-distribution (OOD) data. However, recent work has shown that some features learned by IRL methods only pretend to be invariant on the training distributions but fail on unseen OOD data. This "fake invariance" severely harms OOD generalization.

- Existing methods fail to model the "fake invariance" effect and their solutions are invalid. The paper reviews InvRat methods under two common causal assumptions and shows they cannot represent fake invariant features.

Proposed Solution:
- The paper proposes a ReStructured Causal Model (RS-SCM) that unifies and reconstructs both real invariant features and fake invariant features (caused by shortcuts from spurious features). 

- Based on RS-SCM, a conditional mutual information objective is proposed to identify real and fake invariant features. By maximizing mutual information between labels and real invariant features, and minimizing it between labels and fake features, the method eliminates fake and spurious effects.

- The proposed solution is implemented via an interplay training framework with a small feature selection subnet that alternatively optimizes the InvRat objective and fake invariance rectification objective.

Main Contributions:
- First work to rigorously incorporate fake invariant variables into a causal model (RS-SCM) to reflect such effect.

- Theoretically analyze why InvRat methods fail to identify fake invariance under different assumptions and prove the efficacy of the proposed rectification approach.

- Propose an interplay learning framework and conditional mutual information objective that can effectively eliminate fake and spurious effects for invariant representation learning.

- Experimental results validate the superiority of the proposed method over InvRat baselines on diagnostic OOD datasets and five large-scale domain generalization benchmarks.
