# [Trajectory Consistency Distillation](https://arxiv.org/abs/2402.19159)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper "Trajectory Consistency Distillation":

Problem:
Latent Consistency Models (LCMs) have shown impressive performance in accelerating high-quality text-to-image synthesis by extending Consistency Models to the latent space. However, LCMs struggle to generate images with both high clarity and intricate details, especially when using more sampling steps. The paper investigates this issue and identifies three main error sources: 1) estimation errors in the score matching model, 2) distillation errors in the consistency model, and 3) discretization errors accumulating during sampling.

Proposed Solution - Trajectory Consistency Distillation (TCD): 
To address the above issues, the paper proposes TCD which contains two key components:

1. Trajectory Consistency Function (TCF): Expands the consistency boundary condition to encompass the entire trajectory of the Probability Flow ODE instead of just the endpoint. This enables accurate tracking along the full trajectory, reducing distillation errors. Three TCF parameterizations are proposed based on exponential integrators and Taylor expansion.

2. Strategic Stochastic Sampling (SSS): Introduces a stochastic parameter to control the ending point and noise level at each step of the sampling process. This allows bi-directional traversal of the trajectory to suppress accumulated discretization and estimation errors.

Together, TCF and SSS significantly improve sample quality and detail compared to LCMs, especially at higher number of function evaluations. TCD also exceeds the performance of the teacher model on various metrics.

Main Contributions:
- Identifies three main error sources limiting LCMs - distillation, estimation and discretization 
- Proposes novel TCF to reduce distillation errors by expanding consistency boundary condition
- Introduces SSS to minimize accumulated discretization and estimation errors  
- Achieves superior sample quality and detail compared to LCMs and teacher model
- Demonstrates versatility by accelerating sampling for a variety of conditional diffusion models

The paper makes notable contributions in diagnosing and overcoming limitations of consistency models for text-to-image synthesis. TCD offers valuable insights and techniques to enhance sample quality for generative modeling.
