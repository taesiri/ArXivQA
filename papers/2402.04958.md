# [Channel-Selective Normalization for Label-Shift Robust Test-Time   Adaptation](https://arxiv.org/abs/2402.04958)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement:
- Deep neural networks suffer performance drops when deployed in real-world scenarios due to distribution shifts between training and test data. This is a key challenge in applications like medical imaging.

- Test-time adaptation (TTA) methods like test-time batch normalization (TTN) can adjust models to new distributions during inference. However, prior TTA methods fail to handle label distribution shifts, where the relative proportion of classes changes between training and deployment.

- Label shifts can cause catastrophic failures in TTN, disproportionately affecting the majority class in the test set. This risk limits the practical utility of TTN and TTA.

Proposed Solution:
- The paper proposes Hybrid-TTN to enable benefits of TTN while controlling risks of label shifts. 

- Hybrid-TTN selects channels insensitive to label shifts for adaptation by scoring sensitivity to classes using Wasserstein distance between batch norm statistics.

- A depth-based prior is used to adapt fewer channels in later layers which tend to be more class-specific. 

- Class distribution estimates are obtained with pseudolabeling to weight channel scores.

Contributions:
- Shows that label shifts can cause catastrophic failure of TTN even without covariate shift.

- Proposes channel scoring and selection method to control risks of label shifts during adaptation.

- Validates Hybrid-TTN on CIFAR-10, ImageNet, and across ultrasound datasets with distribution shifts.

- Hybrid-TTN consistently improves utility of adaptation compared to source and other methods across shifts.

- Allows benefits of TTN adaptation while avoiding catastrophic failures due to label shifts.

In summary, the paper identifies and tackles a key limitation of TTN and TTA methods with a principled channel selection approach to enable safer adaptation under label distribution shifts.
