# [CaDRE: Controllable and Diverse Generation of Safety-Critical Driving   Scenarios using Real-World Trajectories](https://arxiv.org/abs/2403.13208)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: Simulation-based testing is crucial for developing autonomous vehicles (AVs), but generating safety-critical driving scenarios remains challenging. Such scenarios are rare but potentially fatal, so AVs must be robustly evaluated on them. Key difficulties include ensuring scenario realism, diversity, and controllability. 

Proposed Solution: This paper introduces CaDRE, a novel generative framework to produce diverse and controllable safety-critical driving scenarios using real-world trajectories. 

The core idea is to formulate this as a Quality-Diversity (QD) problem. CaDRE perturbs trajectories from a real-world dataset to maintain realism, while explicitly optimizing for diversity and quality of scenarios. Users can retrieve scenarios matching desired criteria to enable controllability.


Specifically, CaDRE:

1) Defines an objective function to quantify safety-critical level, and measure functions to capture diverse behaviors.

2) Employs a QD algorithm called CMA-ME to efficiently explore the perturbation space, updating an archive of elite scenarios. 

3) Introduces an Occupancy-Aware Restart mechanism to improve QD exploration.

4) Allows controllable retrieval of safety-critical scenarios from the archive using user-defined measure values.


Experiments on three traffic scenarios (unprotected turns, lane changes, U-turns) demonstrate CaDRE generates more diverse and higher quality scenarios compared to reinforcement learning and sampling baselines.


Main Contributions:

- Novel QD formulation for controllable and diverse safety-critical scenario generation

- Occupancy-Aware Restart mechanism to enhance QD algorithm exploration  

- Superior performance over baselines; generates richer driving scenarios for AV testing
