# [Open-Vocabulary Calibration for Vision-Language Models](https://arxiv.org/abs/2402.04655)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Vision-language models (VLMs) like CLIP show promising performance on open-vocabulary image recognition tasks when adapted to downstream datasets using prompt tuning methods. However, the reliability of predictions from fine-tuned VLMs is underexplored. 
- The paper studies the confidence calibration of fine-tuned VLMs and finds that they tend to be underconfident on base/seen classes but overconfident on novel/unseen classes.
- Existing calibration methods can mitigate miscalibration on base classes but fail to transfer to novel classes. Hence, there is a need for calibration techniques tailored to the open-vocabulary setting.

Proposed Solution:
- The paper analyzes the gap between textual features of base and novel classes after prompt tuning. A larger gap correlates to overconfidence on novel classes.
- A new post-hoc calibration method called Distance-Aware Calibration (DAC) is proposed. It scales temperature using a textual deviation score that quantifies the distribution gap between a novel class and base classes.
- For novel classes far from base distribution, DAC assigns higher temperatures to reduce overconfidence. For base classes, it reduces to vanilla temperature scaling.

Main Contributions:
- First systematic study of confidence calibration in fine-tuned VLMs under open-vocabulary settings.
- Analysis revealing overconfidence on novel classes correlated with textual distribution gaps.
- A simple and effective post-hoc calibration technique DAC that leverages textual proximity to improve reliability on novel classes.
- Extensive experiments with 7 prompt tuning methods on 11 datasets demonstrate DAC's consistency in boosting open-vocabulary calibration.

In summary, this paper identifies and addresses the problem of miscalibration on novel classes for finetine-tuned VLMs via a distance-aware temperature scaling approach. The proposed DAC technique is model-agnostic and helps enhance reliability.
