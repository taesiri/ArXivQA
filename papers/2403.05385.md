# [Switching the Loss Reduces the Cost in Batch Reinforcement Learning](https://arxiv.org/abs/2403.05385)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- In offline/batch reinforcement learning, the goal is to learn a good policy from a fixed dataset without any further environment interactions. Fitted Q-Iteration (FQI) is a standard approach but it uses squared loss to train the Q-function estimates. 

- The paper shows theoretically and empirically that using squared loss fails to take advantage of problems where the optimal policy accumulates low cost. This prevents existing FQI methods from being sample efficient on such problems.

Proposed Solution:
- The paper proposes a variant called FQI with Log Loss (FQI-LL) that trains the Q-function estimates by minimizing log loss instead of squared loss.

- Switching to log loss enables FQI-LL to achieve a small-cost bound, meaning the number of samples required scales with the cost of the optimal policy. This allows faster convergence when the optimal actions reliably achieve low costs.

Main Contributions:

1. FQI-LL is the first batch RL algorithm to achieve a small-cost bound, improving sample efficiency over standard FQI on problems with low optimal cost.

2. New analysis showing the Bellman optimality operator contracts under the Hellinger distance, enabling the small-cost guarantee.

3. Empirical evaluations on Mountain Car and Atari games showing FQI-LL learns better policies with fewer samples than standard FQI in the batch setting.

In summary, the key insight is that log loss emphasizes low-cost transitions unlike squared loss. This helps FQI-LL better leverage trajectories with low costs in the batch dataset, leading to improved sample efficiency. The theoretical and empirical results demonstrate the benefits of this loss switch.
