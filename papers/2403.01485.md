# [Approximations to the Fisher Information Metric of Deep Generative   Models for Out-Of-Distribution Detection](https://arxiv.org/abs/2403.01485)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Deep generative models like variational autoencoders (VAEs), normalizing flows and diffusion models are used to model complex, high-dimensional distributions like images. They allow sampling and likelihood estimation.
- However, these models consistently assign higher likelihoods to out-of-distribution (OOD) data compared to the actual training data distribution. This makes them unsuitable for OOD detection using likelihoods.

Proposed Solution: 
- Use the gradient of the log-likelihood w.r.t. the model parameters, also called the score, for OOD detection.
- Show that the score is invariant to invertible input transformations, an important property called representation invariance.
- Approximate the size of the score using the Fisher information metric. Show the Fisher information matrix (FIM) is diagonally dominant, motivating a layer-wise score approximation.
- Use the chi-square distributed layer-wise gradient L2 norms as features and model their distribution jointly using Gaussians for in-distribution scores.

Main Contributions:
- Proof that score is invariant to input representation changes, unlike likelihood.
- Analysis showing FIM is diagonally dominant, enabling efficient layer-wise approximation. 
- Simple, model-agnostic method using layer-wise gradient L2 norms and their distribution for anomaly scores.
- Extensive evaluation showing improvements over likelihood-based baseline on various datasets and models.

In summary, the paper proposes using layer-wise gradient norms for OOD detection in deep generative models, shows desirable invariance properties, and demonstrates empirical improvements over likelihoods.
