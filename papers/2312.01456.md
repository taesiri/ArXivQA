# [Compositional Policy Learning in Stochastic Control Systems with Formal   Guarantees](https://arxiv.org/abs/2312.01456)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key aspects of the paper:

Problem: 
Reinforcement learning (RL) policies lack formal guarantees about safety and specification satisfaction, which is an impediment to their deployment in safety-critical applications. Prior compositional verification methods are limited to deterministic systems and linear dynamics. This paper addresses the problem of learning and verifying neural network policies for stochastic control systems with respect to logical specifications in the \SpectRL language, which allows sequential and disjunctive composition of reach-avoid specifications.

Proposed Solution:
The paper proposes \Algo, a novel compositional learning algorithm that decomposes a complex \SpectRL specification into simpler reach-avoid tasks, learns verifiable policies for each task, and composes them into a policy that provably satisfies the global specification. 

Key ideas:
1) Improve the lower bound on reach-avoid probability certified by reach-avoid supermartingales (RASMs), using a new multiplicative RASM formulation. This allows verifying complex multi-step tasks.  

2) Decompose the \SpectRL specification into an abstract graph with reach-avoid specifications on edges. Learn edge policies and RASMs on-demand using a topological ordering. Track reach probabilities across graph to deduce global guarantee.

3) Formal verification of neural network controllers for stochastic systems with non-linear dynamics. Applicable beyond deterministic/linear assumptions of prior verification methods.


Main Contributions:

1) An exponentially tighter lower bound on reach-avoid probability certified by RASMs, using the new multiplicative RASM formulation (Section 3).

2) The \Algo algorithm for compositional, verifiable policy learning for stochastic control systems and \SpectRL specifications. Learns neural network policies and RASM certificates providing end-to-end probabilistic guarantees (Section 4).

3) Evaluation on a stochastic variant of the 9-rooms environment, demonstrating limitations of end-to-end learning and the ability of \Algo to decompose tasks and provide verified guarantee on the composed policy (Section 5).

The key novelty is in enabling compositionality, applicability to stochastic dynamics and neural network policies, and providing formal verification guarantees on complex logical specifications - advancing the state of the art in safe reinforcement learning.
