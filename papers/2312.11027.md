# [Learning Top-k Subtask Planning Tree based on Discriminative   Representation Pre-training for Decision Making](https://arxiv.org/abs/2312.11027)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Many real-world tasks can be decomposed into smaller, more manageable subtasks. Planning and utilizing knowledge extracted from these subtasks is crucial for AI agents to make accurate decisions when facing complex tasks. However, existing methods have two key limitations: (1) They lack the ability to extract discriminative and robust knowledge representations from subtask data. (2) They cannot effectively utilize the learned knowledge to plan the execution of subtasks to solve more complex composite tasks.

Proposed Solution:
This paper introduces a framework with two key components to address the limitations:

1. Discriminative Subtask Representation Learning: A multi-encoder architecture is used where each encoder learns representations for one subtask. This prevents interference across different subtasks. A shared predictor is also used to predict rewards and state transitions. This forces the encoders to capture the essential dynamics of each subtask. Contrastive learning ensures distinctiveness of representations across subtasks.

2. Top-k Subtask Planning Tree: An attention module is used to construct a tree comprising the top-k most relevant subtasks to solve the given complex task. The tree plans the sequence and combinations of subtasks that need to be executed. A discounted UCB method is used to find the optimal path through the tree to guide the agent's actions.

Main Contributions:

- A novel method to learn distinguishable and informative knowledge representations from subtask data using multiple encoders and an auxiliary prediction task.

- An algorithm to automatically construct a top-k subtask planning tree to plan the execution of subtasks for solving complex tasks.

- Demonstrated superior performance over competitive baselines on complex navigation tasks in BabyAI that require long-horizon planning and compositional understanding.

The key advantage is the ability to extract useful knowledge representations from simple subtasks and leverage that knowledge to effectively plan solutions for more complex tasks. This improves sample efficiency and performance on composite tasks.
