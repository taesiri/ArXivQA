# [DSPy Assertions: Computational Constraints for Self-Refining Language   Model Pipelines](https://arxiv.org/abs/2312.13382)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Chaining language model (LM) calls as composable modules is becoming a popular way to build complex NLP pipelines. However, ensuring LMs adhere to important constraints remains challenging, often requiring extensive "prompt engineering".

Proposed Solution: 
- The paper introduces "LM Assertions", a new programming construct for expressing computational constraints that LMs in a pipeline should satisfy. 
- There are two types of LM Assertions:
  1) Hard "Assertions" that halt the pipeline if violated after retries
  2) Soft "Suggestions" that trigger self-refinement but allow the pipeline to continue if unresolved
- LM Assertions are integrated into the DSPy programming framework. When failed, they enable automatic backtracking to retry and self-refine the LM, injecting information about past failures into the prompt.

Key Contributions:
- Formalizes semantics and implementation details of the proposed LM Assertions.
- Demonstrates LM Assertions can significantly improve compliance to imposed constraints, with gains up to 35.7% on an information retrieval task.  
- Shows constrained self-refinement also improves downstream performance, with gains up to 13.3% in answer accuracy by refining search queries.
- Evaluates on a long-form QA task requiring citations, finding over 16.7% more faithful citations using LM Assertions.

In summary, the paper introduces the LM Assertions programming construct to express computational constraints and rules for language models. When integrated into the DSPy framework, LM Assertions enable new capabilities for automated self-refinement and backtracking to improve reliability, accuracy and task performance.
