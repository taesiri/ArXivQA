# [NTIRE 2023 Image Shadow Removal Challenge Technical Report: Team IIM_TTI](https://arxiv.org/abs/2403.08995)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- The NTIRE2023 Shadow Removal Challenge dataset contains misalignments between shadow and shadow-free image pairs due to changes in external camera parameters. This poses an additional challenge beyond just shadow removal. 
- Existing shadow removal methods like ShadowFormer don't explicitly handle such misalignments.
- ShadowFormer also uses loss functions like Charbonnier loss that limit perceptual quality.
- It relies on an external shadow detection model that requires fine-tuning on this dataset which lacks shadow masks. 
- The shadow detection and removal models are trained independently which limits potential improvements.

Proposed Solution - "ShadowFormer+":

- Explicitly estimates a homography between image pairs to align them as a pre-processing step. This transforms the shadow-free image to match the one with shadows.

- Uses a perceptual quality loss, specifically a Structure Preservation loss matched in a DiNO feature space along with an edge-based SSIM loss for better quality.

- Introduces a "Semi-Automatic Shadow Mask Annotation" method to automatically predict shadow masks from the V channel of HSV images to supervise the shadow detector.  

- Uses joint training of the shadow detector MTMT model and ShadowFormer removal model end-to-end to improve both.

- Introduces a novel data augmentation method "CutShadow" that cuts and pastes shadow image patches onto shadow-free images.

Main Contributions:

- Analysis of misalignment issue in the challenge dataset and using explicit alignment.

- Use of perceptual losses for visually better shadow removal.  

- Automatic method to annotate shadow masks from available data itself without manual effort. Enables supervised tuning of detection model.

- Joint end-to-end training of shadow detector and remover models.

- New data augmentation strategy CutShadow for generating augmented shadow data.

The proposed ShadowFormer+ method achieves high rankings in both LPIPS (3rd out of 19) and Mean Opinion Score (3rd out of 19). Both quantitative metrics and qualitative results demonstrate effectiveness of the improvements over baseline ShadowFormer.
