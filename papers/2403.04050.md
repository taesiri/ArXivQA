# [Belief-Enriched Pessimistic Q-Learning against Adversarial State   Perturbations](https://arxiv.org/abs/2403.04050)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Reinforcement learning (RL) agents are vulnerable to adversarial attacks, especially perturbations on their state observations. Prior defenses using regularization or alternating training of agent/attacker policies have limitations.  

- Two key limitations: (1) mismatch between training on true states and testing on perturbed states leads to instability, (2) lack of explicitly modeling and reducing uncertainty about true states based on observations.

Proposed Solution:
- Formulate problem as Stackelberg game between RL agent (leader) and attacker (follower). Propose pessimistic Q-learning algorithm that chooses actions maximizing worst-case Q-value over possible true states.  

- Maintain belief over true states using particle filters or diffusion models. Use belief to reduce uncertainty when selecting pessimistic actions.

- Develop two algorithms: Belief-enriched Pessimistic DQN (BP-DQN) using particle filters for structured state spaces, and Diffusion-assisted Pessimistic DQN (DP-DQN) using diffusion models for raw pixel inputs.

Main Contributions:
- New paradigm for robust RL using pessimistic actions based on maximin optimization and explicit state uncertainty modeling via beliefs/diffusion.

- Achieves superior performance to prior defenses like regularization or alternating training, especially against strong attacks.

- BP-DQN reduces uncertainty via particle filtering in structured state spaces. DP-DQN leverages diffusion models to purify perturbed pixel observations.

- Analysis bounding performance loss due to pessimism. Empirical evaluation demonstrates advantages over baselines on Gridworld and Atari games.
