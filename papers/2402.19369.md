# [Structure Preserving Diffusion Models](https://arxiv.org/abs/2402.19369)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
- Diffusion models have become leading generative models, but often the data they model has inherent symmetries or invariances (e.g. image distributions are invariant to rotation/flipping)
- It is desirable for the model to preserve these invariances, both for consistency and to prevent introducing biases
- However, there has been little study on imposing such symmetries on diffusion models

Proposed Solution:
- Introduce the concept of "structure preserving" diffusion processes that theoretically preserve invariances of the data distribution
- Show that a diffusion process preserves invariance to a transformation group if and only if its drift function is equivariant to that group 
- Propose methods to make diffusion models equivariant:
   - SPDiff+WT: Use weight-tied convolutions to make model equivariant
   - SPDiff+OC: Combine outputs of multiple non-equivariant models
   - SPDiff+Reg: Regularize model training with equivariance losses
- Show how to achieve equivariant sampling trajectories for applications like image denoising

Main Contributions:
- Formal study of symmetry preservation in diffusion models, with theoretical results on when this holds
- Novel methods to impose equivariance on diffusion models, with theoretical guarantees
- Empirical validation over rotated MNIST and microscopy datasets
- Applications to equivariant image denoising 

The key insight is diffusion processes preserve symmetries if and only if the drift (flow field) is equivariant. The paper proposes practical ways to achieve this equivariance, enabling provably symmetry-preserving diffusion models.
