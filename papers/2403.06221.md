# [TRAD: Enhancing LLM Agents with Step-Wise Thought Retrieval and Aligned   Decision](https://arxiv.org/abs/2403.06221)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem:
Existing large language model (LLM) agents that utilize in-context learning with expert demonstrations can suffer from issues of plausible examples (retrieved demonstrations may not match the actual task despite similar instructions), context limits of LLMs (long input sequences exceed model capacity), and irrelevant information in prompts (LLMs are sensitive to prompts and can copy irrelevant content). Recent methods retrieve full trajectories with task metadata, but this can result in the aforementioned issues. 

Proposed Solution:
The paper proposes TRAD, a novel LLM agent framework comprising of Thought Retrieval and Aligned Decision modules. Thought Retrieval conducts step-wise retrieval of expert demonstration steps using the LLM's current "thought" (reasoning of its state) as a query. This provides more precise and relevant steps as context. Aligned Decision complements the retrieved steps with their temporal neighbor steps and relative position marks. This provides tolerance for imperfect thoughts and more useful context.

Key Contributions:
1) A thought retrieval method that enables step-wise expert demonstration retrieval using LLM thoughts as queries/keys for the first time.
2) An aligned decision method that complements retrieved steps with temporal neighbors and position marks for more informative action prediction.  
3) Experiments showing TRAD achieves state-of-the-art performance on ALFWorld and Mind2Web benchmarks, outperforming methods like Synapse and ReAct.
4) Analysis showing thought retrieval reduces irrelevant context/noise and aligned decision provides useful context for generalization.
5) Real-world deployment showing significant boosts in success rates for robotic process automation scenarios in an insurance company.

The paper proposes a novel and effective LLM agent augmentation technique to address demonstration selection issues via step-wise retrieval and context enhancement. Experiments, analysis and real-world deployment validate the effectiveness of TRAD in improving LLM agent success over strong baselines.
