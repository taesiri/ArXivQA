# [Weakly Supervised Object Detection in Chest X-Rays with Differentiable   ROI Proposal Networks and Soft ROI Pooling](https://arxiv.org/abs/2402.11985)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Weakly supervised object detection (WSup-OD) is useful for localizing diseases in medical images as it only requires image-level labels which are easier to obtain than bounding box labels. 
- However, current WSup-OD methods designed for natural images do not work well for medical images. Multiple Instance Learning (MIL) methods rely on region proposal algorithms like Selective Search and Edge Boxes which fail to capture subtle and diffuse diseases. Class Activation Map (CAM) methods also have limitations in localization accuracy.

Proposed Solution:
- The paper proposes Weakly Supervised ROI Proposal Networks (WSRPN), a novel end-to-end trainable bounding box proposal algorithm requiring only image-level labels.
- WSRPN has two branches - a patch classification branch and an ROI proposal branch with ROI attention. The ROI attention uses cross-attention between learned ROI tokens and image patches to predict bounding boxes represented by the tokens. 
- A Gaussian-based soft ROI pooling is used to aggregate features for each ROI token from the image patches based on the predicted box parameters. This allows end-to-end optimization of the box parameters.
- The two branches are trained jointly using a MIL framework with losses like binary cross-entropy on aggregated class probabilities and supervised contrastive loss on patch and ROI features. An additional consistency loss ensures agreement between branches.

Main Contributions:
- Proposes a novel, fully differentiable, end-to-end trainable bounding box proposal algorithm for WSup-OD in medical images.
- Outperforms state-of-the-art for disease localization on CXR8 chest X-ray dataset, setting new benchmarks.
- Enables optimizing box parameters directly using different signals like text or anatomy information, which is impossible in other WSup-OD methods.
- Opens up new research directions in weakly supervised pathology detection beyond limitations of existing MIL and CAM-based approaches.
