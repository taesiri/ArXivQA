# [Token-Specific Watermarking with Enhanced Detectability and Semantic   Coherence for Large Language Models](https://arxiv.org/abs/2402.18059)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Large language models (LLMs) can generate high-quality and coherent texts that are difficult to distinguish from human-written ones. This necessitates techniques to determine if a text is AI-generated, known as watermarking. Current watermarking methods face tradeoffs between ensuring high detectability of watermarks while maintaining the semantic integrity of generated texts. Enhancing one aspect often compromises the other.  

Proposed Solution:
This paper introduces a novel multi-objective optimization (MOO) approach for watermarking that utilizes two lightweight networks - a γ-generator and a δ-generator. During text generation, these networks output token-specific splitting ratios (γ) and watermark logits (δ) for vocabulary splitting and biasing chosen tokens. The networks are trained via MOO to optimize two objectives:
1) Watermark detectability: Quantified via a differentiable z-test surrogate loss
2) Semantic integrity: Measured via cosine similarity between embeddings of watermarked and non-watermarked texts

By finding Pareto optimal solutions, the method concurrently improves detectability and preserves semantics.

Main Contributions:
- A new watermarking technique that leverages MOO for simultaneously enhancing detectability and semantic quality
- Introduction of lightweight token-specific γ- and δ-generator networks for controlled vocabulary splitting and logit biasing
- Comprehensive experiments showing superior performance over baselines in achieving detectability and semantic objectives together
- Analysis of learned γ and δ values indicating adaptation of watermark strength based on token semantics

In summary, this paper makes notable contributions in advancing watermarking for LLMs through a specialized MOO approach that overcomes limitations of prior arts in balancing detectability and semantic coherence. The introduced method and analysis offer valuable insights into controlled watermarking sensitive to textual semantics.
