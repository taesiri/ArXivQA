# [Recursive Speculative Decoding: Accelerating LLM Inference via Sampling   Without Replacement](https://arxiv.org/abs/2402.14160)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Large language models (LLMs) suffer from slow inference speed due to their auto-regressive nature and memory bandwidth bottlenecks. 
- Speculative decoding methods have been proposed to accelerate LLM inference by using a smaller draft model to generate draft tokens in parallel, followed by the target LLM verifying them.
- Recent tree-based methods build a draft token tree for better diversity, but sample tokens independently without considering dependencies, limiting the tree's diversifiability.

Proposed Solution:
- The paper proposes Recursive Speculative Decoding (RSD), a novel tree-based method that constructs the draft token tree by sampling without replacement to maximize diversity.
- Two versions are presented - RSD with Constant branching factors (RSD-C) uses Gumbel-Top-k to sample tokens without replacement, while RSD with Stochastic Beam Search (RSD-S) samples sequences without replacement, allowing early truncation of unlikely sequences to reduce computational cost.
- A new theoretical concept called recursive rejection sampling is introduced to verify the sampling-without-replacement draft tree while still recovering the exact target LLM distribution.

Main Contributions:
- Introduction of recursive rejection sampling for speculative decoding with sampling without replacement draft distributions.
- Proposal of RSD algorithms that construct highly diverse draft token trees via sampling without replacement using Gumbel-Top-k (RSD-C) or Stochastic Beam Search (RSD-S). 
- Empirical evaluation from two perspectives - fixed draft sequence length and fixed computational budget, showing RSD outperforms baselines like speculative decoding and SpecTr overall.
- Establishes the benefit of sampling without replacement for improving diversity of draft token trees in speculative decoding.

In summary, the key innovation of the paper is RSD, which builds a diverse draft token tree by sampling without replacement, enabling faster and more accurate LLM inference. The theoretical concept of recursive rejection sampling supports this approach.
