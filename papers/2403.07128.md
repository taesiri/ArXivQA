# [FAX: Scalable and Differentiable Federated Primitives in JAX](https://arxiv.org/abs/2403.07128)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem:
- Federated learning (FL) involves training machine learning models over decentralized data located on multiple clients. Performing FL computations introduces challenges around scalability, efficiency, and ease of algorithm expression compared to traditional centralized training.
- Existing FL frameworks have limitations in simultaneously providing performant data center execution, easy algorithm expression via automated differentiation, and integration with production cross-device FL systems.

Proposed Solution:
- The paper presents FAX, a library for defining federated computations based on JAX primitives. 
- FAX represents federated values as arrays with an extra dimension indicating their placement at the server or clients. Federated computations like broadcast, map, and sum are implemented as JAX primitives operating on these placed arrays.
- Embedding federated building blocks as JAX primitives allows FAX to:
  - Compile federated computations into efficient XLA code
  - Leverage JAX's sharding to scale across devices
  - Implement federated automatic differentiation (FAD) by defining Jacobian-vector products for the primitives
  - Generate program representations preserving placement for translation to production systems

Main Contributions:
- FAX provides a framework for scalable and efficient federated computations in the data center, demonstrating near constant runtime for federated training of large language models with up to 8 billion parameters and 512 clients.
- FAX implements FAD, greatly simplifying the expression of federated algorithms like FedSGD via automatic differentiation.
- FAX generates interpretable program representations that can be translated to production cross-device FL systems while preserving information about data placement and communication.

In summary, FAX enables easy authoring, scalable execution and differentiation of federated programs while keeping open the possibility of translation to real-world cross-device FL systems.
