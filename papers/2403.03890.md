# [Hierarchical Diffusion Policy for Kinematics-Aware Multi-Task Robotic   Manipulation](https://arxiv.org/abs/2403.03890)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
Learning efficient robotic manipulation policies is challenging. End-to-end approaches that directly map from visual observations to robot actions tend to be inefficient. Next-best-pose (NBP) agents that predict goal end-effector poses are more efficient but rely on predefined planners that may fail on tasks requiring contextual understanding.

Proposed Solution:
This paper proposes a hierarchical agent called Hierarchical Diffusion Policy (HDP) that combines the strengths of NBP agents and learned context-aware control. HDP factors the policy into:

1) A high-level NBP agent that takes visual observations and language instructions as input and predicts a next-best end-effector pose for a distant future timestep. This enables long-horizon planning.

2) A low-level goal-conditioned diffusion policy called Robot Kinematics Diffuser (RK-Diffuser) that generates optimal motion trajectories to reach the predicted goal pose. RK-Diffuser learns separate diffusion models over end-effector poses and joint positions. It distills the accurate but less reliable end-effector trajectories into joint position space using differentiable robot kinematics, ensuring kinematic feasibility.

Main Contributions:

1) Proposes HDP, a novel hierarchical framework combining task planning and context-aware control for efficient robotic manipulation.

2) Introduces RK-Diffuser, a goal-conditioned diffusion policy that generates kinematically feasible motion trajectories by distilling end-effector poses into joint positions.

3) Empirically demonstrates that HDP achieves significantly higher success rates than state-of-the-art methods on a range of manipulation tasks in both simulation and the real world.

4) Shows that RK-Diffuser outperforms alternatives such as inverse kinematics solvers in enabling accurate and kinematically feasible trajectory generation.

In summary, this paper makes key contributions in hierarchical policy learning and goal-conditioned trajectory generation for robotic manipulation. The proposed HDP framework combines complementary strengths at different levels of reasoning for efficient and generalizable visuomotor control.
