# [ICLN: Input Convex Loss Network for Decision Focused Learning](https://arxiv.org/abs/2403.01875)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper:

Problem: 
In decision-making problems under uncertainty, prediction and optimization are often treated as separate tasks. Prediction-focused learning (PFL) trains a model to make accurate predictions, while decision-focused learning (DFL) trains a model to make predictions that lead to good decisions for the task. Computing gradients for DFL requires differentiating through the optimization problem, which can be intractable. Existing surrogate DFL methods either restrict the optimization domain or build local surrogate losses per data instance, requiring lots of computation.

Proposed Solution:
This paper proposes Input Convex Loss Network (ICLN), a novel global surrogate loss for general DFL problems. ICLN uses Input Convex Neural Networks to guarantee convexity with respect to some inputs while maintaining a global structure. This allows ICLN to represent the task loss for any DFL problem using a single learned loss function, without needing to hand-engineer problem-specific losses. 

Two variants are introduced: 
1) ICLN-L: Learns a local convex loss around each prediction instance 
2) ICLN-G: Learns a global loss that is convex for sampled neighbor predictions but not necessarily for original predictions.

Both only require a pre-processing sampling stage to generate prediction/task loss pairs. The learned loss can then be used to train any predictive model by taking gradients.

Main Contributions:
- Proposes ICLN, the first general, global surrogate loss for DFL requiring only a single learned loss function
- Guarantees convexity for sampled prediction neighbors through Input Convex NN architecture
- Achieves state-of-the-art performance across inventory, knapsack and portfolio optimization tasks
- Requires orders of magnitude fewer loss samples than methods learning local loss models
- Provides ability to perform general DFL without problem-specific loss engineering

In summary, ICLN contribution is a novel, efficient and flexible surrogate DFL approach that can work on any decision-making problem with much less samples than prior arts.
