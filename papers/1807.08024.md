# [Explaining Image Classifiers by Counterfactual Generation](https://arxiv.org/abs/1807.08024)

## What is the central research question or hypothesis that this paper addresses?

Based on my reading of the paper, the central research question seems to be:How can we generate more interpretable saliency maps for explaining the predictions of neural network image classifiers, by leveraging generative models to fill in missing image regions? The key hypotheses appear to be:1) Existing saliency methods that fill in missing regions with heuristics like blurring or noise (e.g. BBMP) can produce artifacts because the infilled images are unnatural and far from the data distribution. This biases the saliency explanations.2) Using conditional generative models to fill in missing regions, conditioned on the surrounding context, will produce more natural and plausible infilled images. 3) Conditioning the generative model infilling on a learned Bernoulli dropout distribution over image regions will allow efficiently searching for optimal explanations while encouraging sparsity.4) The resulting saliency maps, generated by finding regions that maximally preserve or alter classification confidence under generative infilling, will be more compact, relevant, and have fewer artifacts compared to heuristic infilling approaches.In summary, the central hypothesis is that leveraging conditional generative models for infilling will produce more natural, relevant, and interpretable saliency maps for explaining neural network classifiers. The proposed method FIDO is introduced to test this hypothesis.


## What is the main contribution of this paper?

Based on the graphical model diagrams, it looks like the main contribution of this paper is to use a generative model to fill in masked regions of an image when computing saliency maps, rather than using heuristic infilling methods. Specifically, the paper proposes using a conditional generative model p(x_r | x_{\backslash r}) to sample plausible values for a masked region x_r, conditioned on the unmasked pixels x_{\backslash r}. This allows computing the classifier's output when x_r is unobserved by marginalizing it out and sampling from the generative model.In contrast, previous works have used heuristic approaches to fill in the masked regions, such as blurring or injecting random noise. The paper argues that these can produce artifacts and lead to explanations that rely on out-of-distribution inputs. Using a generative model to fill in masked regions encourages the explanations to rely on in-distribution counterfactual inputs.So in summary, the main contribution seems to be using conditional generative models rather than heuristics to fill in masked regions when computing saliency maps and explanations for image classifiers. This produces more plausible and compact explanations.


## How does this paper compare to other research in the same field?

Here are a few thoughts on how this paper compares to other research in the same field of interpreting and explaining neural network classifications:- The approach of using variational dropout and conditioning a generative model to fill in masked regions for computing saliency maps is fairly novel. Many other methods rely on simpler heuristics like blurring/random noise for the reference values. Using a generative model to marginalize out the masked regions provides a more principled way to find counterfactual inputs that plausibly lie on the data manifold.- Compared to other reference-based saliency methods like LIME or SHAP, this paper's approach doesn't require training local surrogate models or relying on Shapley values. The optimization framework to find the minimal masks directly ties the saliency computation to the original classifier.- The quantitative evaluations like the pixel flipping experiments and weakly supervised localization provide concrete ways to measure the quality and compactness of the saliency maps. Many other papers have tended to focus more on qualitative results.- Using stronger generative models like GANs for the in-filling hasn't been explored much for saliency map computation. This paper shows promise in leveraging advances in generative modeling to improve explanations.- The connections made to variational inference and modeling the conditional density of the input features provides an interesting probabilistic interpretation. This viewpoint relates model explanations to broader topics like marginalization and data imputation.Overall, I think the paper introduces some novel ideas around using generative models and variational dropout for saliency computation. The results demonstrate improved visual quality and quantitative performance over existing methods on benchmark tasks. Situating the method in a probabilistic framework also helps relate it to the broader literature on model explanations and interpretations.


## What future research directions do the authors suggest?

Based on my reading of the paper, some of the main future research directions suggested by the authors include:- Developing more sophisticated inference techniques for variational dropout models that go beyond mean-field approximations. The authors mention exploring more advanced variational inference methods like normalizing flows or auxiliary variable techniques.- Exploring the utility of variational dropout for broader applications beyond vision, such as in natural language processing tasks. The properties of the variational dropout technique may lend themselves well to sequence modeling tasks.- Further theoretical analysis of the regularization effects of variational dropout, and relating it to other regularization techniques like data augmentation. There may be connections between variational dropout and other stochastic regularizers that could provide insight.- Exploring conditional variational dropout models that condition on auxiliary inputs like class labels. This could allow flexibly controlling the amount of dropout per class to account for differences in training set sizes.- Developing adaptive schemes for automatically tuning the dropout rates based on training dynamics. Rather than fixing the rates, adapting them during training may improve results.- Combining variational dropout with other stochastic regularization methods like dropout or stochastic depth to analyze their interactions. The techniques may complement each other in beneficial ways.In summary, the authors propose a number of interesting future directions centered around developing variational dropout further, both in terms of theory, methods, and applications. The technique shows promise as a principled Bayesian regularization approach.


## Summarize the paper in one paragraph.

Here is a one paragraph summary of the paper:The paper proposes a new model-agnostic framework for explaining image classifiers based on variational Bernoulli dropout and generative in-filling. The key idea is to compute saliency maps by partitioning the input image into observed and unobserved pixels, then marginalizing out the unobserved pixels by sampling plausible values from a conditional generative model. This encourages explanations consistent with the data distribution, in contrast to previous approaches that use ad-hoc heuristics to fill in masked regions. The method poses saliency computation as an optimization problem to find a minimal set of input pixels that preserve classifier confidence when filled in by the generator. Experiments on ImageNet show the approach produces more compact and relevant saliency maps compared to prior methods, with fewer artifacts. Overall, the paper demonstrates the value of leveraging powerful generative models within a variational dropout framework to explain differentiable classifiers with counterfactually-plausible saliency maps.


## Summarize the paper in two paragraphs.

Here is a two paragraph summary of the paper:The paper presents a new model-agnostic framework for explaining the classifications of differentiable classifiers using variational Bernoulli dropout and generative in-filling. The key idea is to partition the input features into a masked (unobserved) region and its complement. The masked region is then in-filled by sampling from a conditional generative model to create plausible counterfactual inputs. By optimizing the Bernoulli dropout rates to find masks that maximally change the classifier's predictions when in-filled, compact and relevant saliency maps can be produced that identify pixels most important for the classification. The proposed method, called FIDO (Fill-In Dropout), is compared to prior saliency approaches that use heuristic in-filling, which can result in unrealistic out-of-distribution inputs. By leveraging powerful generative models like Contextual Attention GANs, FIDO produces more concentrated and cleaner saliency maps with fewer artifacts on ImageNet images. Quantitative evaluations demonstrate FIDO identifies more compact pixel regions that alter classifier confidence compared to existing methods when successively removed. The use of strong generative in-filling is shown to encourage plausible explanations consistent with the data distribution.


## Summarize the main method used in the paper in one paragraph.

Here is a one paragraph summary of the main method used in the paper:The paper proposes a new model-agnostic framework for explaining image classifiers based on variational Bernoulli dropout. Given an input image and a trained classifier, the method introduces a binary mask over the input pixels, where 1 indicates the pixel is observed and 0 means it is unobserved. The unobserved pixels are then filled in by sampling from a conditional generative model. By optimizing the Bernoulli dropout probabilities to minimize classifier score, the method identifies a minimal set of input pixels that are most relevant for the classifier's prediction when filled in realistically. This framework encourages the generated counterfactual inputs to remain on the data manifold. The use of a powerful conditional generative model like a GAN provides more plausible in-filling, avoiding artifacts that could improperly influence the saliency computation. Overall, the approach produces saliency maps that identify compact pixel regions critical for preserving the classifier's decision.
