# [Brain-on-Switch: Towards Advanced Intelligent Network Data Plane via   NN-Driven Traffic Analysis at Line-Speed](https://arxiv.org/abs/2403.11090)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the paper "Brain-on-Switch: Towards Advanced Intelligent Network Data Plane via NN-Driven Traffic Analysis at Line-Speed":

Problem:
Prior works on Intelligent Network Data Plane (INDP) focus on deploying tree/forest models on the data plane of programmable switches. However, the features that can be computed on-switch are limited due to hardware constraints, restricting the accuracy of tree-based models. This paper aims to enable neural network (NN) driven traffic analysis at line-speed on the data plane to overcome these limitations.

Proposed Solution: 
The paper proposes Brain-on-Switch (BoS), the first INDP system that enables NN inference for traffic analysis at line-speed. The key ideas are:

1) A novel binary RNN architecture to run on-switch. It retains full-precision weights to maximize accuracy while using binary activations for efficiency. The RNN computations are realized via input-output mapping tables.

2) A sliding window mechanism to execute unlimited RNN time steps with limited switch stages. This recurrently processes fixed-length packet segments using a ring buffer.

3) An off-switch transformer module called Integrated Model Inference System (IMIS) to handle low-confidence flows escalated from the switch. IMIS accuracy selects these flows and processes them with low latency.  

Together, the on-switch binary RNN analyzes most traffic at line-speed, while IMIS boosts overall accuracy.

Main Contributions:
- First INDP system to enable NN inference for traffic analysis at line-speed
- Innovative binary RNN design optimized for switch hardware constraints  
- Sliding window mechanism for unlimited RNN steps using limited stages 
- IMIS system to integrate advanced off-switch models at low latency
- Prototype using P4 switch and transformer model, outperforming state-of-the-art on 4 tasks
