# [Hierarchical Motion Planning and Offline Robust Model Predictive Control   for Autonomous Vehicles](https://arxiv.org/abs/2402.04769)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem Statement
- Driving autonomous vehicles (AVs) under harsh conditions like adverse roads and uncertain vehicle parameters is a major challenge. The goal is to develop motion planning and control methods for AVs to navigate complex scenarios safely. 

Proposed Solution
- A hierarchical framework with motion planning (upper layer) and robust control (lower layer) is proposed. 

- In the upper layer, an optimal trajectory is generated using the artificial potential field (APF) method to avoid collisions by formulating surroundings as potentials. This handles complex scenarios with roads, lanes, static/dynamic obstacles modeled as potentials.

- In the lower layer, an offline constrained robust model predictive control (RMPC) method is used to track the optimal trajectory from the upper layer. It handles uncertain vehicle parameters using a linear parameter varying (LPV) system model. Constraints on inputs and states are included to ensure stability and performance.  

- The vehicle model is augmented with the steering rate for better handling of input vibrations. This is the key novelty compared to other RMPC methods.

Main Contributions
- A hierarchical planning and control framework for AVs to handle complex uncertain scenarios:
    - APF-based optimal trajectory generation (upper layer)
    - Offline constrained RMPC with augmented vehicle model (lower layer)

- Improved efficiency over other RMPC variants in: 
   - Computational time  
   - Reduced input vibrations
   - Balanced tracking performance and stability

- Demonstrated performance in simulation case studies with normal, aggressive and unexpected driving scenarios


## Summarize the paper in one sentence.

 This paper proposes a hierarchical motion planning and control strategy using artificial potential field path planning and constrained robust model predictive control to enable autonomous vehicles to safely navigate complex driving scenarios under uncertain vehicle parameters and low-friction road conditions.


## What is the main contribution of this paper?

 The two main contributions of this paper are:

(i) An optimal trajectory is generated by formulating obstacle potential values via the artificial potential field (APF) method. This allows the autonomous vehicle (AV) to avoid different obstacles in arbitrary complex scenarios. 

(ii) By augmenting the vehicle model, the approach handles the steering wheel angle rate to improve input vibrations and vehicle stability when driving on various road adhesion coefficients at relatively high speed. This emphasizes efficiency compared to other robust model predictive control (RMPC) methods like offset-offline RMPC, online RMPC, and offline RMPC without an augmented model.

So in summary, the main contributions are using APF for optimal trajectory generation to handle complex scenarios, and augmenting the vehicle model in the robust control design to improve efficiency. The proposed hierarchical motion planning and control strategy balances performance across trajectory tracking, stability, and computational burden.


## What are the keywords or key terms associated with this paper?

 Some of the key terms and keywords associated with this paper include:

- Hierarchical motion planning 
- Offline robust model predictive control (RMPC)
- Autonomous vehicles (AVs)
- Artificial potential field (APF)
- Linear parameter varying (LPV) system 
- Linear matrix inequality (LMI) optimization
- Intelligent Driver Model (IDM)
- Vehicle-to-everything (V2X) technology
- Robustness against model parameter uncertainties
- Improving computing time and reducing input vibrations
- Handling complex driving scenarios 
- Various road adhesion coefficients

The paper proposes a hierarchical framework with motion planning in the upper layer to generate optimal trajectories using APF to avoid collisions. The lower layer employs an offline RMPC strategy based on LMI optimization for an LPV model to achieve robustness against uncertainties and improve tracking performance. Comparisons are made to online RMPC and other methods to show efficiency improvements. The overall strategy aims to enable autonomous vehicles to handle complex driving scenarios under different road conditions in a robust and efficient manner.


## Design 10 in-depth questions about the method proposed in this paper and avoid simple questions.

 Here are 10 in-depth questions about the method proposed in this paper:

1. The paper proposes a hierarchical framework with motion planning in the upper layer and robust control in the lower layer. What is the rationale behind using a hierarchical approach instead of a single integrated strategy? How do the layers coordinate and pass information between each other? 

2. The artificial potential field (APF) method is used for motion planning to avoid collisions. What are some pros and cons of using APF versus other motion planning methods like sampling-based planners? How is the balance between computational complexity and optimality considered?

3. What specific modifications or enhancements were made to the standard APF formulation in order to make it suitable for autonomous driving applications? How were factors like road boundaries, lanes, and dynamic obstacles incorporated?

4. Linear matrix inequalities (LMIs) are leveraged to design the robust model predictive controller (RMPC). Explain the process of forming the LMIs for constraints handling and stability analysis. What role does the Lyapunov function play?

5. How does the offline design process for RMPC help improve computational efficiency compared to online optimization? What is being pre-computed and stored for online implementation?

6. Explain the purpose of augmenting the vehicle model before developing the RMPC. How does this help specifically address input chattering and stability issues? 

7. The RMPC considers an LPV model to account for varying parameters like tire stiffness. How are the bounds and polytopic uncertainty sets for these parameters determined? 

8. What advantages does the proposed approach have compared to the other existing robust MPC methods analyzed in simulation? What practical limitations need to be still addressed?

9. How can the hierarchical approach be extended for urban and crowded scenarios with pedestrians, intersections etc.? What additional sensing and algorithms may be required?

10. The paper focuses on lateral vehicle control. How can the framework be enhanced for longitudinal control as well during autonomous driving? What coordination strategies between lateral and longitudinal control can be incorporated?
