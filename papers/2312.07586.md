# [Characteristic Guidance: Non-linear Correction for DDPM at Large   Guidance Scale](https://arxiv.org/abs/2312.07586)

## Write a very high-quality and detailed summary of the paper that describes the paper in a way that a human can fully understand. The summary should cover the problem, the proposed solution and highlight the main contributions of the paper.

 Here is a detailed summary of the key points from the paper:

Problem: 
- Popular denoising diffusion probabilistic models (DDPMs) use classifier-free guidance to enhance control over sample generation by linearly combining conditional and unconditional models. 
- However, this overlooks nonlinear effects that become significant at large guidance scales, causing issues like color distortion and loss of sample quality.

Proposed Solution:
- The paper proposes "characteristic guidance", a novel non-linear correction method for classifier-free guided DDPMs. 
- It forces the guided DDPM to respect the Fokker-Planck equation of the underlying diffusion process. This is done in a way that is first-principle, training-free, derivative-free, and compatible with existing sampling algorithms.

Key Contributions:
- Derives the method using the harmonic ansatz and method of characteristics to solve the Fokker-Planck equation. This allows exploiting accuracy of classifier-free guidance at initial time while avoiding issues later.
- Introduces projection operators as regularization that accelerates computation for natural images.
- Experiments across conditional Gaussians, mixture of Gaussians, phase transitions in magnets, CIFAR-10 and ImageNet show robustness.
- Enhances control over samples, eliminates color/exposure issues even for latent space sampling, and handles phase transitions in physics problems.
- Provides a general framework to correct guided DDPM models at large guidance scales by adjusting scores/noises.

Limitations:
- Iterative process to compute non-linear correction can be slow and unstable without proper regularization.
- Harmonic ansatz approximations degrade at very small diffusion times.

In summary, the paper makes a novel, first-principle and non-linear correction to classifier-free guidance in DDPMs that is theoretically grounded, overcomes quality issues, and demonstrates versatility across diverse test cases.
